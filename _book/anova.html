<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 ANOVA | Understanding Statistical Thinking With Linear Models</title>
  <meta name="description" content="Chapter 5 ANOVA | Understanding Statistical Thinking With Linear Models" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 ANOVA | Understanding Statistical Thinking With Linear Models" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 ANOVA | Understanding Statistical Thinking With Linear Models" />
  
  
  

<meta name="author" content="Dan MacLean" />


<meta name="date" content="2020-07-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="t-tests-and-linear-models.html"/>
<link rel="next" href="final-words.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Statistics Primer</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#models-in-biology-models-in-stats"><i class="fa fa-check"></i><b>2.1</b> Models in biology, models in stats</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#the-zig-zag-zig-model-in-plant-disease-immunity"><i class="fa fa-check"></i><b>2.1.1</b> The zig-zag-zig model in plant disease immunity</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#slopes-of-straight-lines-can-help-us-think-about-differences-between-samples"><i class="fa fa-check"></i><b>2.2</b> Slopes of straight lines can help us think about differences between samples</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>3</b> The Linear Model</a><ul>
<li class="chapter" data-level="3.1" data-path="the-linear-model.html"><a href="the-linear-model.html#straight-line-relationships-are-described-using-two-parameters"><i class="fa fa-check"></i><b>3.1</b> Straight line relationships are described using two parameters</a></li>
<li class="chapter" data-level="3.2" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-try-to-create-a-linear-equation-from-data"><i class="fa fa-check"></i><b>3.2</b> Linear models try to create a linear equation from data</a></li>
<li class="chapter" data-level="3.3" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-describe-relationships-between-variables"><i class="fa fa-check"></i><b>3.3</b> Linear models describe relationships between variables</a></li>
<li class="chapter" data-level="3.4" data-path="the-linear-model.html"><a href="the-linear-model.html#not-all-lines-of-best-fit-are-equally-good"><i class="fa fa-check"></i><b>3.4</b> Not all lines of best fit are equally good</a></li>
<li class="chapter" data-level="3.5" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-contain-statistics-describing-the-goodness-of-the-model"><i class="fa fa-check"></i><b>3.5</b> Linear models contain statistics describing the goodness of the model</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-linear-model.html"><a href="the-linear-model.html#residual-standard-error"><i class="fa fa-check"></i><b>3.5.1</b> Residual Standard Error</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-linear-model.html"><a href="the-linear-model.html#r2"><i class="fa fa-check"></i><b>3.5.2</b> <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="3.5.3" data-path="the-linear-model.html"><a href="the-linear-model.html#r2-versus-residual-standard-error"><i class="fa fa-check"></i><b>3.5.3</b> <span class="math inline">\(R^2\)</span> versus Residual Standard Error</a></li>
<li class="chapter" data-level="3.5.4" data-path="the-linear-model.html"><a href="the-linear-model.html#f-statistic"><i class="fa fa-check"></i><b>3.5.4</b> <span class="math inline">\(F\)</span>-Statistic</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-linear-model.html"><a href="the-linear-model.html#coefficients-have-statistics"><i class="fa fa-check"></i><b>3.6</b> Coefficients have statistics</a><ul>
<li class="chapter" data-level="3.6.1" data-path="the-linear-model.html"><a href="the-linear-model.html#estimate"><i class="fa fa-check"></i><b>3.6.1</b> Estimate</a></li>
<li class="chapter" data-level="3.6.2" data-path="the-linear-model.html"><a href="the-linear-model.html#std.-error"><i class="fa fa-check"></i><b>3.6.2</b> Std. Error</a></li>
<li class="chapter" data-level="3.6.3" data-path="the-linear-model.html"><a href="the-linear-model.html#t-value"><i class="fa fa-check"></i><b>3.6.3</b> <span class="math inline">\(t\)</span>-value</a></li>
<li class="chapter" data-level="3.6.4" data-path="the-linear-model.html"><a href="the-linear-model.html#prt"><i class="fa fa-check"></i><b>3.6.4</b> <span class="math inline">\(Pr(&gt;|t|)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="the-linear-model.html"><a href="the-linear-model.html#a-non-zero-slope-is-what-matters"><i class="fa fa-check"></i><b>3.7</b> A non-zero slope is what matters</a></li>
<li class="chapter" data-level="3.8" data-path="the-linear-model.html"><a href="the-linear-model.html#major-points"><i class="fa fa-check"></i><b>3.8</b> Major points</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html"><i class="fa fa-check"></i><b>4</b> <span class="math inline">\(t\)</span>-tests and linear models</a><ul>
<li class="chapter" data-level="4.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#recap"><i class="fa fa-check"></i><b>4.1</b> Recap</a><ul>
<li class="chapter" data-level="4.1.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-slope-of-the-model-again"><i class="fa fa-check"></i><b>4.1.1</b> The slope of the model again</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-plantgrowth-data"><i class="fa fa-check"></i><b>4.2</b> The PlantGrowth data</a></li>
<li class="chapter" data-level="4.3" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#a-linear-model-with-a-categoric-x-axis"><i class="fa fa-check"></i><b>4.3</b> A linear model with a categoric <span class="math inline">\(x\)</span>-axis</a></li>
<li class="chapter" data-level="4.4" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#using-the-statistics-of-the-linear-model-to-test-for-differences"><i class="fa fa-check"></i><b>4.4</b> Using the statistics of the linear model to test for differences</a><ul>
<li class="chapter" data-level="4.4.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-coefficient-and-the-mean-difference-between-groups-are-equivalent"><i class="fa fa-check"></i><b>4.4.1</b> The coefficient and the mean difference between groups are equivalent</a></li>
<li class="chapter" data-level="4.4.2" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-p-value-of-the-co-efficient-tests-the-same-thing-as-a-t-test"><i class="fa fa-check"></i><b>4.4.2</b> The <span class="math inline">\(p\)</span>-value of the co-efficient tests the same thing as a <span class="math inline">\(t\)</span>-test</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#summary"><i class="fa fa-check"></i><b>4.5</b> Summary</a></li>
<li class="chapter" data-level="4.6" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#but-wasnt-the-t-test-just-easier"><i class="fa fa-check"></i><b>4.6</b> But wasn’t the <span class="math inline">\(t\)</span>-test just easier?</a></li>
<li class="chapter" data-level="4.7" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#task"><i class="fa fa-check"></i><b>4.7</b> Task</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>5</b> ANOVA</a><ul>
<li class="chapter" data-level="5.1" data-path="anova.html"><a href="anova.html#comparing-multiple-groups-in-a-single-variable"><i class="fa fa-check"></i><b>5.1</b> Comparing multiple groups in a single variable</a><ul>
<li class="chapter" data-level="5.1.1" data-path="anova.html"><a href="anova.html#one-way-comparisons"><i class="fa fa-check"></i><b>5.1.1</b> One-Way Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="anova.html"><a href="anova.html#comparing-groups-in-multiple-variables"><i class="fa fa-check"></i><b>5.2</b> Comparing groups in multiple variables</a><ul>
<li class="chapter" data-level="5.2.1" data-path="anova.html"><a href="anova.html#two-way-comparisons"><i class="fa fa-check"></i><b>5.2.1</b> Two-Way Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="anova.html"><a href="anova.html#interactions-of-variables---synergistic-effects"><i class="fa fa-check"></i><b>5.3</b> interactions of variables - synergistic effects</a></li>
<li class="chapter" data-level="5.4" data-path="anova.html"><a href="anova.html#summary-1"><i class="fa fa-check"></i><b>5.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Understanding Statistical Thinking With Linear Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anova" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> ANOVA</h1>
<div id="comparing-multiple-groups-in-a-single-variable" class="section level2">
<h2><span class="header-section-number">5.1</span> Comparing multiple groups in a single variable</h2>
<p>In the last section we looked at using the linear model to compare two groups, in this section we’ll look at using it to compare more than two. One thing to note is that we’re still working with only one explanatory variable, the groups we are talking about are basically different values that the one variable can take. In the <code>PlantGrowth</code> data the variable is called <code>group</code> and the values it takes are <code>ctrl</code>, <code>trt1</code> and <code>trt2</code>.</p>
<div class="todo">
<p>TODO GLOSSARY EXPLANATORY VARIABLE, GROUPS LEVELS, FACTOR</p>
</div>
<p>You’ll be pleased to know this is where the pay off comes. Any number of groups is no more complicated than the two we’ve already done.</p>
<p>We can visualise the process as simply being a case where we have more than one line to examine.</p>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>And putting that in a linear model is no different than before because we have only one variable.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> PlantGrowth)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">summary</span>(model)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ group, data = PlantGrowth)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0710 -0.4180 -0.0060  0.2627  1.3690 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.0320     0.1971  25.527   &lt;2e-16 ***
## grouptrt1    -0.3710     0.2788  -1.331   0.1944    
## grouptrt2     0.4940     0.2788   1.772   0.0877 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6234 on 27 degrees of freedom
## Multiple R-squared:  0.2641, Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
<p>Great! so we handle the extra cases nearly perfectly. There are two lines of coefficient results, the first showing the gradient between the <code>ctrl</code> and <code>trt1</code> and the second showing the gradient between <code>ctrl</code> and <code>trt2</code>. The <code>ctrl</code> data has clearly been used as a common reference - this is the default design in the function, the first group in the data becomes the common reference. Here we get away with it, as we do want the first level to be the common reference. When you need to change the order, you can set the reference level explicitly.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">df &lt;-<span class="st"> </span>PlantGrowth</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">df<span class="op">$</span>group&lt;-<span class="st"> </span><span class="kw">relevel</span>(df<span class="op">$</span>group, <span class="dt">ref=</span><span class="st">&quot;trt2&quot;</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span>group  , <span class="dt">data =</span> df,)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw">summary</span>(model2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ group, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0710 -0.4180 -0.0060  0.2627  1.3690 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.5260     0.1971  28.032  &lt; 2e-16 ***
## groupctrl    -0.4940     0.2788  -1.772  0.08768 .  
## grouptrt1    -0.8650     0.2788  -3.103  0.00446 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6234 on 27 degrees of freedom
## Multiple R-squared:  0.2641, Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
<p>And now we see the <code>trt2</code> as common reference against the <code>ctrl</code> and <code>trt1</code> groups.</p>
<p>In these data <code>ctrl vs trt1</code> appears to be significant according to the linear model <code>model1</code> and <code>trt1 vs trt2</code> appears to be significant according to the linear model <code>model2</code> but we did need to create two models to do this. If this seems longwinded or illogical, then that’s fair. The two models have the same data and specification so should have the same results in - it was really just the way we were ordering things in the data that was different. The real problem is that the models are rich and not all the comparisons that can be done with them can easily be written in <code>summary(model)</code>. To get around this an analysis technique for getting specific comparisions (or contrasts in the statistics jargon) from linear models has been invented, that technique is called ANOVA (Analysis of Variance).</p>
<div id="one-way-comparisons" class="section level3">
<h3><span class="header-section-number">5.1.1</span> One-Way Comparisons</h3>
<p>When we want to do comparisons between groups in a linear model we need to use ANOVA.
Now that we have a solid way of thinking about contrasts as the slope between the categories, we can think of ANOVA as a tool for pulling out the significances in the best way. All we have to do is learn how to specify the contrasts for ANOVA.</p>
<p>Every time we do ANOVA we need a model to feed into it. Here’s the most common way ANOVA is done in R, with the <code>aov()</code> and <code>TukeyHSD()</code> functions, you’ve probably seen this before.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">ano &lt;-<span class="st"> </span><span class="kw">aov</span>(model)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">TukeyHSD</span>(ano)</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = model)
## 
## $group
##             diff        lwr       upr     p adj
## trt1-ctrl -0.371 -1.0622161 0.3202161 0.3908711
## trt2-ctrl  0.494 -0.1972161 1.1852161 0.1979960
## trt2-trt1  0.865  0.1737839 1.5562161 0.0120064</code></pre>
<p>Which is limited and applies only when the standard assumptions of ANOVA are met.</p>
<p>A better alternative is the <code>multcomp</code> package function <code>glht()</code> (general linear model hypothesis test), which is more flexible with respect to which designs and contrasts you can get out, at the expense of being a little more complicated.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(multcomp)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">tested &lt;-<span class="st"> </span><span class="kw">glht</span>(model, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">group =</span> <span class="st">&quot;Tukey&quot;</span>))</a></code></pre></div>
<p>The <code>linfct</code> option just takes a specification of the things to be tested, and the <code>mcp()</code> function generates the comparison based on a text description, here that the variable <code>group</code> should be analysed by ‘Tukey’.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">summary</span>(tested)</a></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = weight ~ group, data = PlantGrowth)
## 
## Linear Hypotheses:
##                  Estimate Std. Error t value Pr(&gt;|t|)  
## trt1 - ctrl == 0  -0.3710     0.2788  -1.331   0.3909  
## trt2 - ctrl == 0   0.4940     0.2788   1.772   0.1980  
## trt2 - trt1 == 0   0.8650     0.2788   3.103   0.0121 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>By printing the summary we see the contrast hypotheses writ explicitly (e.g. the difference between <code>ctrl</code> and <code>trt1</code> is 0) and the conclusions: there is no evidence to suggest either treatment is different from the control, but the difference we observe between the <code>group1</code> and <code>group2</code> occurs by chance only about 1.2 percent of the time.</p>
</div>
</div>
<div id="comparing-groups-in-multiple-variables" class="section level2">
<h2><span class="header-section-number">5.2</span> Comparing groups in multiple variables</h2>
<div id="two-way-comparisons" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Two-Way Comparisons</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">library</span>(palmerpenguins)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">ggplot</span>(penguins) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(species, bill_length_mm) <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> sex), <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.5</span>))</a></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">lm</span>(bill_length_mm <span class="op">~</span><span class="st"> </span>species <span class="op">+</span><span class="st"> </span>sex, <span class="dt">data =</span> penguins)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">summary</span>(model)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bill_length_mm ~ species + sex, data = penguins)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.0869 -1.3770 -0.0709  1.2254 11.0131 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       36.9770     0.2307  160.25   &lt;2e-16 ***
## speciesChinstrap  10.0099     0.3413   29.33   &lt;2e-16 ***
## speciesGentoo      8.6975     0.2871   30.29   &lt;2e-16 ***
## sexmale            3.6939     0.2548   14.50   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.325 on 329 degrees of freedom
##   (11 observations deleted due to missingness)
## Multiple R-squared:  0.8209, Adjusted R-squared:  0.8193 
## F-statistic: 502.8 on 3 and 329 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># setup comparisons explicitly</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">comps &lt;-<span class="st"> </span><span class="kw">mcp</span>( <span class="dt">species =</span> <span class="kw">c</span>(<span class="st">&quot;Chinstrap - Gentoo = 0&quot;</span>,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                          <span class="st">&quot;Chinstrap - Adelie = 0&quot;</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">                          ),</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">              <span class="dt">sex =</span> <span class="kw">c</span>(<span class="st">&quot;male - female = 0&quot;</span>)</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">            )</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="kw">summary</span>(<span class="kw">glht</span>(model, <span class="dt">linfct =</span> comps))</a></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: User-defined Contrasts
## 
## 
## Fit: lm(formula = bill_length_mm ~ species + sex, data = penguins)
## 
## Linear Hypotheses:
##                                  Estimate Std. Error t value Pr(&gt;|t|)    
## species: Chinstrap - Gentoo == 0   1.3123     0.3534   3.713 0.000688 ***
## species: Chinstrap - Adelie == 0  10.0099     0.3413  29.329  &lt; 1e-04 ***
## sex: male - female == 0            3.6939     0.2548  14.497  &lt; 1e-04 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">## or steal from individual comparisons...</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">sex_comps &lt;-<span class="st"> </span><span class="kw">glht</span>(model, <span class="kw">mcp</span>(<span class="dt">sex =</span> <span class="st">&quot;Tukey&quot;</span>))<span class="op">$</span>linfct</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">species_comps &lt;-<span class="st"> </span><span class="kw">glht</span>(model, <span class="kw">mcp</span>(<span class="dt">species =</span> <span class="st">&quot;Tukey&quot;</span>))<span class="op">$</span>linfct</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">comps &lt;-<span class="st"> </span><span class="kw">rbind</span>(sex_comps, species_comps)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="kw">summary</span>(<span class="kw">glht</span>(model, <span class="dt">linfct =</span> comps))</a></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Fit: lm(formula = bill_length_mm ~ species + sex, data = penguins)
## 
## Linear Hypotheses:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## male - female == 0        3.6939     0.2548  14.497  &lt; 1e-04 ***
## Chinstrap - Adelie == 0  10.0099     0.3413  29.329  &lt; 1e-04 ***
## Gentoo - Adelie == 0      8.6975     0.2871  30.293  &lt; 1e-04 ***
## Gentoo - Chinstrap == 0  -1.3123     0.3534  -3.713 0.000926 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
<div id="interactions-of-variables---synergistic-effects" class="section level2">
<h2><span class="header-section-number">5.3</span> interactions of variables - synergistic effects</h2>
<p>line is visualised as …
blah blah</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(bill_length_mm <span class="op">~</span><span class="st"> </span>species <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>species<span class="op">:</span>sex, <span class="dt">data =</span> penguins)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw">summary</span>(model2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bill_length_mm ~ species + sex + species:sex, data = penguins)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7904 -1.3735 -0.0638  1.2096 11.4265 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)               37.2575     0.2710 137.473  &lt; 2e-16 ***
## speciesChinstrap           9.3160     0.4808  19.377  &lt; 2e-16 ***
## speciesGentoo              8.3063     0.4073  20.393  &lt; 2e-16 ***
## sexmale                    3.1329     0.3833   8.174 6.64e-15 ***
## speciesChinstrap:sexmale   1.3877     0.6799   2.041   0.0421 *  
## speciesGentoo:sexmale      0.7771     0.5721   1.358   0.1753    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.316 on 327 degrees of freedom
##   (11 observations deleted due to missingness)
## Multiple R-squared:  0.8234, Adjusted R-squared:  0.8207 
## F-statistic:   305 on 5 and 327 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># setup comparisons explicitly</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co"># comps &lt;- mcp( species = c(&quot;Chinstrap - Gentoo = 0&quot;,</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#                           &quot;Chinstrap - Adelie = 0&quot;</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#                           ),</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#               sex = c(&quot;male - female = 0&quot;),</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#               species:sex = c(&quot;Chinstrap-male - Gentoo-female&quot;)</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#             )</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#summary(glht(model2, linfct = comps))</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb20-11" data-line-number="11">penguins <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">double =</span> <span class="kw">if_else</span>(sex <span class="op">==</span><span class="st"> &#39;male&#39;</span> <span class="op">&amp;</span><span class="st"> </span>species <span class="op">==</span><span class="st"> &#39;Chinstrap&#39;</span>, <span class="st">&quot;male_Chinstrap&quot;</span>, <span class="st">&quot;other&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="st">  </span><span class="kw">aes</span>(species, bill_length_mm) <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> sex), <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>double)</a></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">supplement =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Formula X1&quot;</span>,<span class="st">&quot;Formula X2&quot;</span>), <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">compost =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;John Innes #1&quot;</span>, <span class="st">&quot;John Innes #2&quot;</span>, <span class="st">&quot;John Innes #2&quot;</span>, <span class="st">&quot;John Innes #1&quot;</span>), <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">size =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">runif</span>(<span class="dv">32</span>))</a>
<a class="sourceLine" id="cb22-4" data-line-number="4">df &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb22-5" data-line-number="5">  <span class="dt">supplement =</span> supplement,</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">  <span class="dt">compost =</span> compost,</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">  <span class="dt">size =</span> size</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">size =</span> <span class="kw">if_else</span>( (supplement <span class="op">==</span><span class="st"> &quot;Formula X1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>compost <span class="op">==</span><span class="st"> &quot;John Innes #2&quot;</span>), (size <span class="op">+</span><span class="st"> </span><span class="dv">1</span>), size) )</a>
<a class="sourceLine" id="cb22-10" data-line-number="10"></a>
<a class="sourceLine" id="cb22-11" data-line-number="11">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(supplement <span class="op">==</span><span class="st"> &quot;Formula X1&quot;</span>, compost <span class="op">==</span><span class="st"> &quot;John Innes #2&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 8 x 3
##   supplement compost        size
##   &lt;chr&gt;      &lt;chr&gt;         &lt;dbl&gt;
## 1 Formula X1 John Innes #2  1.92
## 2 Formula X1 John Innes #2  1.53
## 3 Formula X1 John Innes #2  1.14
## 4 Formula X1 John Innes #2  1.07
## 5 Formula X1 John Innes #2  1.90
## 6 Formula X1 John Innes #2  1.62
## 7 Formula X1 John Innes #2  1.15
## 8 Formula X1 John Innes #2  1.87</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(compost, size) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> supplement), <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.5</span>))</a></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co">#mod &lt;- lm(new_val ~ var1 + var2 + var1*var2, data = df)</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="co">#summary(mod)</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="co">#summary(glht(model, linfct = mcp(var1 = &quot;Tukey&quot;)))</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="co">#contrasts(as.factor(df$var1))</span></a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Enjoyment = col_double(),
##   Food = col_character(),
##   Condiment = col_character()
## )</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## 
## Call:
## lm(formula = Enjoyment ~ Condiment, data = food)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -23.1480 -14.3140   0.6796  13.3480  27.1631 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        79.182      2.375  33.336   &lt;2e-16 ***
## CondimentMustard   -3.725      3.359  -1.109    0.271    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 15.02 on 78 degrees of freedom
## Multiple R-squared:  0.01552,    Adjusted R-squared:  0.0029 
## F-statistic:  1.23 on 1 and 78 DF,  p-value: 0.2709</code></pre>
<pre><code>##  Named num [1:80] 75.5 75.5 75.5 75.5 75.5 ...
##  - attr(*, &quot;names&quot;)= chr [1:80] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</code></pre>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-10-1.png" width="50%" /><img src="intro_to_stats_files/figure-html/unnamed-chunk-10-2.png" width="50%" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">food <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">food_num =</span> <span class="kw">if_else</span>( Food <span class="op">==</span><span class="st"> &quot;Hot Dog&quot;</span>, <span class="dv">1</span>, <span class="dv">2</span>) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(Food, Enjoyment) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_jitter</span>( <span class="kw">aes</span>(<span class="dt">colour =</span> Condiment)) <span class="op">+</span><span class="st">   </span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_smooth</span>(</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">    <span class="kw">aes</span>(<span class="dt">x =</span> food_num, <span class="dt">y =</span> Enjoyment, <span class="dt">colour =</span> Condiment), </a>
<a class="sourceLine" id="cb30-7" data-line-number="7">    <span class="dt">method =</span> lm</a>
<a class="sourceLine" id="cb30-8" data-line-number="8">  )  <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="summary-1" class="section level2">
<h2><span class="header-section-number">5.4</span> Summary</h2>
<p>That’s all we need to do to perform ANOVAs with linear models - which always use linear models anyway.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="t-tests-and-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="final-words.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["intro_to_stats.pdf", "intro_to_stats.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
