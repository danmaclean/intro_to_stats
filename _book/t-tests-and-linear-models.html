<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 \(t\)-tests and linear models | Understanding Statistical Thinking With Linear Models</title>
  <meta name="description" content="Chapter 4 \(t\)-tests and linear models | Understanding Statistical Thinking With Linear Models" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 \(t\)-tests and linear models | Understanding Statistical Thinking With Linear Models" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 \(t\)-tests and linear models | Understanding Statistical Thinking With Linear Models" />
  
  
  

<meta name="author" content="Dan MacLean" />


<meta name="date" content="2020-07-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-linear-model.html"/>
<link rel="next" href="anova-and-linear-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Statistics Primer</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#models-in-biology-models-in-stats"><i class="fa fa-check"></i><b>2.1</b> Models in biology, models in stats</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#the-zig-zag-zig-model-in-plant-disease-immunity"><i class="fa fa-check"></i><b>2.1.1</b> The zig-zag-zig model in plant disease immunity</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#slopes-of-straight-lines-can-help-us-think-about-differences-between-samples"><i class="fa fa-check"></i><b>2.2</b> Slopes of straight lines can help us think about differences between samples</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>3</b> The Linear Model</a><ul>
<li class="chapter" data-level="3.1" data-path="the-linear-model.html"><a href="the-linear-model.html#straight-line-relationships-are-described-using-two-parameters"><i class="fa fa-check"></i><b>3.1</b> Straight line relationships are described using two parameters</a></li>
<li class="chapter" data-level="3.2" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-try-to-create-a-linear-equation-from-data"><i class="fa fa-check"></i><b>3.2</b> Linear models try to create a linear equation from data</a></li>
<li class="chapter" data-level="3.3" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-describe-relationships-between-variables"><i class="fa fa-check"></i><b>3.3</b> Linear models describe relationships between variables</a></li>
<li class="chapter" data-level="3.4" data-path="the-linear-model.html"><a href="the-linear-model.html#not-all-lines-of-best-fit-are-equally-good"><i class="fa fa-check"></i><b>3.4</b> Not all lines of best fit are equally good</a></li>
<li class="chapter" data-level="3.5" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-contain-statistics-describing-the-goodness-of-the-model"><i class="fa fa-check"></i><b>3.5</b> Linear models contain statistics describing the goodness of the model</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-linear-model.html"><a href="the-linear-model.html#residual-standard-error"><i class="fa fa-check"></i><b>3.5.1</b> Residual Standard Error</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-linear-model.html"><a href="the-linear-model.html#r2"><i class="fa fa-check"></i><b>3.5.2</b> <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="3.5.3" data-path="the-linear-model.html"><a href="the-linear-model.html#r2-versus-residual-standard-error"><i class="fa fa-check"></i><b>3.5.3</b> <span class="math inline">\(R^2\)</span> versus Residual Standard Error</a></li>
<li class="chapter" data-level="3.5.4" data-path="the-linear-model.html"><a href="the-linear-model.html#f-statistic"><i class="fa fa-check"></i><b>3.5.4</b> <span class="math inline">\(F\)</span>-Statistic</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-linear-model.html"><a href="the-linear-model.html#coefficients-have-statistics"><i class="fa fa-check"></i><b>3.6</b> Coefficients have statistics</a><ul>
<li class="chapter" data-level="3.6.1" data-path="the-linear-model.html"><a href="the-linear-model.html#estimate"><i class="fa fa-check"></i><b>3.6.1</b> Estimate</a></li>
<li class="chapter" data-level="3.6.2" data-path="the-linear-model.html"><a href="the-linear-model.html#std.-error"><i class="fa fa-check"></i><b>3.6.2</b> Std. Error</a></li>
<li class="chapter" data-level="3.6.3" data-path="the-linear-model.html"><a href="the-linear-model.html#t-value"><i class="fa fa-check"></i><b>3.6.3</b> <span class="math inline">\(t\)</span>-value</a></li>
<li class="chapter" data-level="3.6.4" data-path="the-linear-model.html"><a href="the-linear-model.html#prt"><i class="fa fa-check"></i><b>3.6.4</b> <span class="math inline">\(Pr(&gt;|t|)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="the-linear-model.html"><a href="the-linear-model.html#a-non-zero-slope-is-what-matters"><i class="fa fa-check"></i><b>3.7</b> A non-zero slope is what matters</a></li>
<li class="chapter" data-level="3.8" data-path="the-linear-model.html"><a href="the-linear-model.html#major-points"><i class="fa fa-check"></i><b>3.8</b> Major points</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html"><i class="fa fa-check"></i><b>4</b> <span class="math inline">\(t\)</span>-tests and linear models</a><ul>
<li class="chapter" data-level="4.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#recap"><i class="fa fa-check"></i><b>4.1</b> Recap</a><ul>
<li class="chapter" data-level="4.1.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-slope-of-the-model-again"><i class="fa fa-check"></i><b>4.1.1</b> The slope of the model again</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-plantgrowth-data"><i class="fa fa-check"></i><b>4.2</b> The PlantGrowth data</a></li>
<li class="chapter" data-level="4.3" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#a-linear-model-with-a-categoric-x-axis"><i class="fa fa-check"></i><b>4.3</b> A linear model with a categoric <span class="math inline">\(x\)</span>-axis</a></li>
<li class="chapter" data-level="4.4" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#using-the-statistics-of-the-linear-model-to-test-for-differences"><i class="fa fa-check"></i><b>4.4</b> Using the statistics of the linear model to test for differences</a><ul>
<li class="chapter" data-level="4.4.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-coefficient-and-the-mean-difference-between-groups-are-equivalent"><i class="fa fa-check"></i><b>4.4.1</b> The coefficient and the mean difference between groups are equivalent</a></li>
<li class="chapter" data-level="4.4.2" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-p-value-of-the-co-efficient-tests-the-same-thing-as-a-t-test"><i class="fa fa-check"></i><b>4.4.2</b> The <span class="math inline">\(p\)</span>-value of the co-efficient tests the same thing as a <span class="math inline">\(t\)</span>-test</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#summary"><i class="fa fa-check"></i><b>4.5</b> Summary</a></li>
<li class="chapter" data-level="4.6" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#but-wasnt-the-t-test-just-easier"><i class="fa fa-check"></i><b>4.6</b> But wasn’t the <span class="math inline">\(t\)</span>-test just easier?</a></li>
<li class="chapter" data-level="4.7" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#task"><i class="fa fa-check"></i><b>4.7</b> Task</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html"><i class="fa fa-check"></i><b>5</b> ANOVA and linear models</a><ul>
<li class="chapter" data-level="5.1" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#comparing-groups-in-a-single-variable"><i class="fa fa-check"></i><b>5.1</b> Comparing groups in a single variable</a><ul>
<li class="chapter" data-level="5.1.1" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#one-way-comparisons"><i class="fa fa-check"></i><b>5.1.1</b> One-Way comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#comparing-groups-in-multiple-variables"><i class="fa fa-check"></i><b>5.2</b> Comparing groups in multiple variables</a><ul>
<li class="chapter" data-level="5.2.1" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#two-way-comparisons"><i class="fa fa-check"></i><b>5.2.1</b> Two-Way comparisons</a></li>
<li class="chapter" data-level="5.2.2" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#interaction-between-variables"><i class="fa fa-check"></i><b>5.2.2</b> Interaction between variables</a></li>
<li class="chapter" data-level="5.2.3" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#modelling-an-interaction-effect"><i class="fa fa-check"></i><b>5.2.3</b> Modelling an interaction effect</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#occams-razor"><i class="fa fa-check"></i><b>5.3</b> Occam’s Razor</a></li>
<li class="chapter" data-level="5.4" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#interactions-of-variables---synergistic-effects"><i class="fa fa-check"></i><b>5.4</b> interactions of variables - synergistic effects</a></li>
<li class="chapter" data-level="5.5" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#summary-1"><i class="fa fa-check"></i><b>5.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Understanding Statistical Thinking With Linear Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="t-tests-and-linear-models" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> <span class="math inline">\(t\)</span>-tests and linear models</h1>
<p>In this section we’ll look at how the linear model can be used as a conceptual tool to understand the sort of comparison a <span class="math inline">\(t\)</span>-test does and as a straightforward way to perform a hypothesis test.</p>
<div id="recap" class="section level2">
<h2><span class="header-section-number">4.1</span> Recap</h2>
<p>Because I like hammering this point home, Im going to recap two important points from our work on linear models.</p>
<ol style="list-style-type: decimal">
<li>The slope of the model is the important thing</li>
<li>‘Significance’ tests only test whether the difference between two things is ‘probably not 0’</li>
</ol>
<div id="the-slope-of-the-model-again" class="section level3">
<h3><span class="header-section-number">4.1.1</span> The slope of the model again</h3>
<p>Recall the linear model equation</p>
<p><span class="math display">\[\begin{equation}
y = ax + b
\end{equation}\]</span></p>
<p>and that if we let the coefficient <span class="math inline">\(a = 0\)</span>, the effect of <span class="math inline">\(x\)</span> disappears</p>
<p><span class="math display">\[\begin{equation}
y = 0 x + b\\
y = b
\end{equation}\]</span></p>
<p>So the logical conclusion is that if we have a coefficient that is non-zero, we have a relationship/effect of <span class="math inline">\(x\)</span> on <span class="math inline">\(y\)</span>.</p>
<p>It is this property that let’s us use the linear model to work out whether there is a significant difference between groups! That is to say we can use it as a <span class="math inline">\(t\)</span>-test.</p>
<p>However, the second we try to apply what we’ve learned with the linear model to a two-sample dataset we hit an apparent problem because we’ve learned how to make linear models from datasets with a continuous, numeric <span class="math inline">\(x\)</span>-axis, but the data we have for a <span class="math inline">\(t\)</span>-test has a very different two category look, something like these here:</p>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-20-1.png" width="50%" /><img src="intro_to_stats_files/figure-html/unnamed-chunk-20-2.png" width="50%" /></p>
<p>The question then is what do we do with the categoric data to put it in a linear model?</p>
<p>The first step is to realise that although we are used to thinking of the each of the bars representing a single number, that single number is (almost always) a mean of replicate values, so we go back to those source numbers as a first step</p>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>and we have something a lot more like the scatterplot we’re used to. The next step is to replace the categories with numbers for the <span class="math inline">\(x\)</span>-axis. That means going from data like this</p>
<table>
<thead>
<tr class="header">
<th align="right">group1</th>
<th align="right">group2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4.895422</td>
<td align="right">5.949330</td>
</tr>
<tr class="even">
<td align="right">5.225740</td>
<td align="right">5.357527</td>
</tr>
<tr class="odd">
<td align="right">4.828976</td>
<td align="right">5.803222</td>
</tr>
<tr class="even">
<td align="right">5.878021</td>
<td align="right">5.693268</td>
</tr>
<tr class="odd">
<td align="right">4.068426</td>
<td align="right">6.995864</td>
</tr>
<tr class="even">
<td align="right">4.985580</td>
<td align="right">6.642633</td>
</tr>
</tbody>
</table>
<p>to this</p>
<table>
<thead>
<tr class="header">
<th align="left">group</th>
<th align="right">value</th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">group1</td>
<td align="right">4.895422</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">group1</td>
<td align="right">5.225740</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">group1</td>
<td align="right">4.828976</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">group1</td>
<td align="right">5.878021</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">group1</td>
<td align="right">4.068426</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">group1</td>
<td align="right">4.985580</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">group2</td>
<td align="right">5.949330</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">group2</td>
<td align="right">5.357527</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">group2</td>
<td align="right">5.803222</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">group2</td>
<td align="right">5.693268</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">group2</td>
<td align="right">6.995864</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">group2</td>
<td align="right">6.642633</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>So now we can make a plot that looks a lot more like the one we’re expecting</p>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>albeit with the <span class="math inline">\(x\)</span>-values in two places on the <span class="math inline">\(x\)</span>-axis - its enough for us to make a slope on the line between the two groups and that means that we can use the linear model for the categoric data, as we did for the continuous.</p>
<p>If this seems like a bit of a ‘hack’ then thats fair, but hacks are usually just pragmatic and useful solutions to problems, this one is completely mathematically legitimate as well as useful.</p>
<p>And if this change in the data reminds you of tidy data we’ve used in other courses, like dplyr, then that is no accident. Tidy data is designed to make this sort of analysis easy to work through, at least as far as organising the data goes.</p>
<p>The good news is that once we have our data setup, the <code>lm()</code> function just deals with these issues for us, we don’t have to worry, the problem of contnuous or categoric <span class="math inline">\(x\)</span>-axes just disappears!</p>
<p>So let’s work through an example of a linear model based hypothesis test for differences between two groups that functions as a <span class="math inline">\(t\)</span>-test.</p>
</div>
</div>
<div id="the-plantgrowth-data" class="section level2">
<h2><span class="header-section-number">4.2</span> The PlantGrowth data</h2>
<p>R comes with lots of datasets built in. One if these is <code>PlantGrowth</code>, which describes the dry weight of plants in grams in replicated measurements in a control and two treatments. We can load it with <code>data()</code> and get a <code>summary()</code></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;PlantGrowth&quot;</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">summary</span>(PlantGrowth)</a></code></pre></div>
<pre><code>##      weight       group   
##  Min.   :3.590   ctrl:10  
##  1st Qu.:4.550   trt1:10  
##  Median :5.155   trt2:10  
##  Mean   :5.073            
##  3rd Qu.:5.530            
##  Max.   :6.310</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">head</span>(PlantGrowth)</a></code></pre></div>
<pre><code>##   weight group
## 1   4.17  ctrl
## 2   5.58  ctrl
## 3   5.18  ctrl
## 4   6.11  ctrl
## 5   4.50  ctrl
## 6   4.61  ctrl</code></pre>
<p>We have three groups and one measurement, in our linear model this means that the <span class="math inline">\(x\)</span> values would come from the <code>group</code> column - because it is categoric rather than continuous as we had before isn’t a concern. The <span class="math inline">\(y\)</span> values would come from the <code>weight</code> column.</p>
<p>In linear modelling jargon, the <span class="math inline">\(x\)</span> values are called the independent or explanatory variable, simply because this is the one we changed over the course of the experiment. The <span class="math inline">\(y\)</span> values are called the dependent or response variables as this is the one that responds or changes according to the changes in the independent variable.</p>
<p>For simplicity at this stage we’ll work with two groups only. Let’s remove <code>trt2</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">two_groups &lt;-<span class="st"> </span>PlantGrowth <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(group <span class="op">!=</span><span class="st"> &quot;trt2&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span><span class="kw">droplevels</span>()</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="kw">summary</span>(two_groups)</a></code></pre></div>
<pre><code>##      weight       group   
##  Min.   :3.590   ctrl:10  
##  1st Qu.:4.388   trt1:10  
##  Median :4.750            
##  Mean   :4.846            
##  3rd Qu.:5.218            
##  Max.   :6.110</code></pre>
<p>With that done, we can look at the categorical scatter plot.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(two_groups) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw">aes</span>(group, weight) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">p</a></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>We can clearly see the weight spread in each group. By eye we can see that the groups overlap in the <span class="math inline">\(y\)</span>-axis (weight) quite considerably, though <code>trt1</code> seems to have a couple of data points that are lower.</p>
</div>
<div id="a-linear-model-with-a-categoric-x-axis" class="section level2">
<h2><span class="header-section-number">4.3</span> A linear model with a categoric <span class="math inline">\(x\)</span>-axis</h2>
<p>Let’s make the linear model and get the intercept and coefficient of the line. This can be done with <code>lm()</code> as we did before, but because we have the data in a dataframe, we need to specify a <code>data</code> argument, which just means ‘look for the data in the given object’.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">two_groups_model &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> two_groups)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">two_groups_model</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ group, data = two_groups)
## 
## Coefficients:
## (Intercept)    grouptrt1  
##       5.032       -0.371</code></pre>
<p>That calculates easily! The <code>lm()</code> isn’t worried by the fact that one of our variables is categoric. It knows all the levels of the <code>group</code> variable and gives us the intercept and coefficient as it did before.</p>
</div>
<div id="using-the-statistics-of-the-linear-model-to-test-for-differences" class="section level2">
<h2><span class="header-section-number">4.4</span> Using the statistics of the linear model to test for differences</h2>
<p>Now we have a categoric linear model built we can start to look at how to use it to check for differences between the groups.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">summary</span>(two_groups_model)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ group, data = two_groups)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0710 -0.4938  0.0685  0.2462  1.3690 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.0320     0.2202  22.850 9.55e-15 ***
## grouptrt1    -0.3710     0.3114  -1.191    0.249    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6964 on 18 degrees of freedom
## Multiple R-squared:  0.07308,    Adjusted R-squared:  0.02158 
## F-statistic: 1.419 on 1 and 18 DF,  p-value: 0.249</code></pre>
<p>From the output we can see the coefficient isn’t huge, only about 1/3 of a gram <em>decrease</em> as we change along the <span class="math inline">\(x\)</span> axis by one unit. Saying change along the axis by one unit in categoric axes sounds a bit strange, but in the categoric data it just means switching from one group to the next. Lets add the line to the plot and have a look.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="fl">5.03</span>, <span class="dt">slope =</span> <span class="fl">-0.371</span>)</a></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>Just looking at the plot makes the line look seem substantial than it is. Looking at the <span class="math inline">\(y\)</span>-axis and the places where the line intercepts with the categories then we can see the difference is close to the coefficient.</p>
<div id="the-coefficient-and-the-mean-difference-between-groups-are-equivalent" class="section level3">
<h3><span class="header-section-number">4.4.1</span> The coefficient and the mean difference between groups are equivalent</h3>
<p>Before we move along with our model, we should look at that coefficient of the group variable a bit more. As we’re moving from the <code>ctrl</code> to <code>treatment</code> groups the coefficient tells us the size of the change. So does this mean that the coefficient is equivalent to other measures by which we can tell the difference in two groups - is it, for example equivalent to calculating the difference in the means of the groups? Short answer is yes! Let’s look at that, recalling that the coefficient is <code>0.371</code>.</p>
<p>First get the means of the groups</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">mean_two_groups &lt;-<span class="st"> </span>two_groups <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_wt =</span> <span class="kw">mean</span>(weight))</a>
<a class="sourceLine" id="cb22-4" data-line-number="4"></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">mean_two_groups</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   group mean_wt
##   &lt;fct&gt;   &lt;dbl&gt;
## 1 ctrl     5.03
## 2 trt1     4.66</code></pre>
<p>Now calculate the difference</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="fl">5.03</span> <span class="op">-</span><span class="st"> </span><span class="fl">4.66</span></a></code></pre></div>
<pre><code>## [1] 0.37</code></pre>
<p>There you have it, the absolute values of each are very similar. You can use the coefficient as a way of finding the difference between the groups. Another handy feature of the linear model.</p>
</div>
<div id="the-p-value-of-the-co-efficient-tests-the-same-thing-as-a-t-test" class="section level3">
<h3><span class="header-section-number">4.4.2</span> The <span class="math inline">\(p\)</span>-value of the co-efficient tests the same thing as a <span class="math inline">\(t\)</span>-test</h3>
<p>We already know that the <span class="math inline">\(Pr(&gt;|t|)\)</span> value (<span class="math inline">\(p\)</span>-value of the coefficient) tells us the probability that we would see the slope observed or greater in random samples if the real difference were 0. The two-sample <span class="math inline">\(t\)</span>-test reports the probability that we would see the difference in means observed if the real difference were 0. So the two are very similar.</p>
<p>The <span class="math inline">\(p\)</span>-value for the coefficient in the linear model was 0.249. How does this compare with a <span class="math inline">\(t\)</span>-test?</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">t.test</span>(weight <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> two_groups)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  weight by group
## t = 1.1913, df = 16.524, p-value = 0.2504
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.2875162  1.0295162
## sample estimates:
## mean in group ctrl mean in group trt1 
##              5.032              4.661</code></pre>
<p>It is extremely close! In fact, as the sample size increase over about 15 it gets to be exact. So this is useful, we can use the linear model slope and <span class="math inline">\(p\)</span>-value as a mental and practical alternative for thinking about the more complicated <span class="math inline">\(t\)</span>-test.</p>
<p>All you have to understand is that you are looking at the slope of the line between the groups. If you don’t see a slope of that size very often, then you can say its not likely that there’s no difference<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
</div>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">4.5</span> Summary</h2>
<p>Hopefully, this plot summarises how to look for differences between two groups using a linear model quite succinctly.</p>
<ol style="list-style-type: decimal">
<li>Think of the line between the mean of the groups</li>
<li>Does the <span class="math inline">\(p\)</span>-value tell you that you don’t see a slope of this size often.</li>
</ol>
<p>So you just need the coefficient and the <span class="math inline">\(p\)</span>-value from the linear model.
When we’re thinking of the coefficient of the linear model for differences we’re just asking something very similar to whether the line that joins the two means has a non-zero slope, given the error.</p>
<p>In a hypothesis test way, what we’re asking amounts to the following two hypotheses:</p>
<ul>
<li>A flat line with slope of zero is equivalent to the Null hypothesis
<ul>
<li><span class="math inline">\(H_{0}\)</span> the group means are equal</li>
</ul></li>
<li>A <span class="math inline">\(p\)</span>-value that suggests the slope is rare is equivalent to the Alternative hypothesis
<ul>
<li><span class="math inline">\(H_{1}\)</span> the group means are not equal</li>
</ul></li>
</ul>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
<div id="but-wasnt-the-t-test-just-easier" class="section level2">
<h2><span class="header-section-number">4.6</span> But wasn’t the <span class="math inline">\(t\)</span>-test just easier?</h2>
<p>In the process we’ve been learning we used the <code>t.test()</code> function to calculate the <span class="math inline">\(p\)</span>-value that tested the hypothesis that the true difference in the means was 0. This was pretty easy and we didn’t have to think too hard, we just got the result. Why wouldn’t we stick to just using that, if it’s equivalent to the linear model? Because the linear model is a general answer to all these sorts of questions - one small set of techniques is useable in pretty much every situation, so in a wide range of experiments the statistics becomes a lot easier to understand, using it in place of all other tests uses basically the same set of skills we’ve applied here, there’s not much more than we already know. Contrast this with the effort and time investment that it would take to learn the many different significance tests and all the different ways that they work.</p>
<p>The ‘learn all the significance tests’ approach restricts us as scientists exploring our data in important ways. For example, the <span class="math inline">\(t\)</span>-test (like all other tests) is a special case of the linear model, it can only be applied reliably when certain conditions are met. The <span class="math inline">\(t\)</span>-test also ‘black-box's’ the whole process, all the output you focus on is a <span class="math inline">\(p\)</span>-value, in practice there isn’t a whole lot to it and unless you study the innards of the <span class="math inline">\(t\)</span>-test you can never compare two <span class="math inline">\(t\)</span>-test results. Have you ever seen a <span class="math inline">\(p\)</span>-value that you couldn’t replicate or looked a bit suspect but couldn’t work out why - using a linear model with all its measures of believability allows such comparisons to be done, you could say exactly why one model fit was better or worse than another and which hypotheses you can keep and reject more confidently. This is a very important point, by using linear models we also have a consistent way to criticise and evaluate our statistical conclusions - helping us to make better decisions and helping us to answer questions (perhaps from reviewers or group leaders) about the applicability and believeability.</p>
<p>Comparing more than two groups and looking at effects is basically the same thing, and we’ll look at that in the next section.</p>
</div>
<div id="task" class="section level2">
<h2><span class="header-section-number">4.7</span> Task</h2>
<p>Make the PlantGrowth plot using <code>geom_smooth()</code> with the error area.
geom_smooth( aes(x = as.numeric(group), y = measurement), method = lm, colour = “red”, linetype = “dashed”)</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Again this is weak inference, but thats this type of statistics for you!<a href="t-tests-and-linear-models.html#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-linear-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anova-and-linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["intro_to_stats.pdf", "intro_to_stats.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
