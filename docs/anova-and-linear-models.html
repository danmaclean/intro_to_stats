<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 7 ANOVA and linear models | Understanding Statistical Thinking With Linear Models</title>
  <meta name="description" content="Topic 7 ANOVA and linear models | Understanding Statistical Thinking With Linear Models" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 7 ANOVA and linear models | Understanding Statistical Thinking With Linear Models" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 7 ANOVA and linear models | Understanding Statistical Thinking With Linear Models" />
  
  
  

<meta name="author" content="Dan MacLean" />


<meta name="date" content="2021-01-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="t-tests-and-linear-models.html"/>
<link rel="next" href="non-parametric-tests-and-linear-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Statistics Primer</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Setting up</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#knowledge-prerequisites"><i class="fa fa-check"></i><b>1.1.1</b> Knowledge prerequisites</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#software-prerequisites"><i class="fa fa-check"></i><b>1.1.2</b> Software prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-r"><i class="fa fa-check"></i><b>1.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installing-rstudio"><i class="fa fa-check"></i><b>1.3</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#installing-r-packages-in-rstudio."><i class="fa fa-check"></i><b>1.4</b> Installing R packages in RStudio.</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#standard-packages---devtools"><i class="fa fa-check"></i><b>1.4.1</b> Standard packages - <code>devtools</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#development-packages---itssl"><i class="fa fa-check"></i><b>1.4.2</b> Development packages - itssl</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#using-the-itssl-package"><i class="fa fa-check"></i><b>1.5</b> Using the <code>itssl</code> package</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Motivation</a></li>
<li class="chapter" data-level="3" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>3</b> Background</a><ul>
<li class="chapter" data-level="3.1" data-path="background.html"><a href="background.html#null-models"><i class="fa fa-check"></i><b>3.1</b> Null Models</a></li>
<li class="chapter" data-level="3.2" data-path="background.html"><a href="background.html#p-values"><i class="fa fa-check"></i><b>3.2</b> <span class="math inline">\(p\)</span>-values</a></li>
<li class="chapter" data-level="3.3" data-path="background.html"><a href="background.html#slopes-of-straight-lines-can-help-us-think-about-differences-between-things"><i class="fa fa-check"></i><b>3.3</b> Slopes of straight lines can help us think about differences between things</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>4</b> The Linear Model</a><ul>
<li class="chapter" data-level="4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#from-straight-lines-to-data"><i class="fa fa-check"></i><b>4.1</b> From straight lines to data</a></li>
<li class="chapter" data-level="4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#straight-line-relationships-are-described-using-two-parameters"><i class="fa fa-check"></i><b>4.2</b> Straight line relationships are described using two parameters</a></li>
<li class="chapter" data-level="4.3" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-try-to-create-a-linear-equation-from-data"><i class="fa fa-check"></i><b>4.3</b> Linear models try to create a linear equation from data</a></li>
<li class="chapter" data-level="4.4" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-describe-relationships-between-variables"><i class="fa fa-check"></i><b>4.4</b> Linear models describe relationships between variables</a></li>
<li class="chapter" data-level="4.5" data-path="the-linear-model.html"><a href="the-linear-model.html#not-all-lines-of-best-fit-are-equally-good"><i class="fa fa-check"></i><b>4.5</b> Not all lines of best fit are equally good</a></li>
<li class="chapter" data-level="4.6" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-contain-statistics-describing-the-goodness-of-the-model"><i class="fa fa-check"></i><b>4.6</b> Linear models contain statistics describing the goodness of the model</a><ul>
<li class="chapter" data-level="4.6.1" data-path="the-linear-model.html"><a href="the-linear-model.html#residual-standard-error"><i class="fa fa-check"></i><b>4.6.1</b> Residual Standard Error</a></li>
<li class="chapter" data-level="4.6.2" data-path="the-linear-model.html"><a href="the-linear-model.html#r2"><i class="fa fa-check"></i><b>4.6.2</b> <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="4.6.3" data-path="the-linear-model.html"><a href="the-linear-model.html#f-statistic"><i class="fa fa-check"></i><b>4.6.3</b> <span class="math inline">\(F\)</span>-Statistic</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="the-linear-model.html"><a href="the-linear-model.html#coefficients-have-statistics"><i class="fa fa-check"></i><b>4.7</b> Coefficients have statistics</a><ul>
<li class="chapter" data-level="4.7.1" data-path="the-linear-model.html"><a href="the-linear-model.html#estimate"><i class="fa fa-check"></i><b>4.7.1</b> Estimate</a></li>
<li class="chapter" data-level="4.7.2" data-path="the-linear-model.html"><a href="the-linear-model.html#std.-error"><i class="fa fa-check"></i><b>4.7.2</b> Std. Error</a></li>
<li class="chapter" data-level="4.7.3" data-path="the-linear-model.html"><a href="the-linear-model.html#t-value"><i class="fa fa-check"></i><b>4.7.3</b> <span class="math inline">\(t\)</span>-value</a></li>
<li class="chapter" data-level="4.7.4" data-path="the-linear-model.html"><a href="the-linear-model.html#prt"><i class="fa fa-check"></i><b>4.7.4</b> <span class="math inline">\(Pr(&gt;|t|)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="the-linear-model.html"><a href="the-linear-model.html#a-non-zero-slope-is-what-matters"><i class="fa fa-check"></i><b>4.8</b> A non-zero slope is what matters</a></li>
<li class="chapter" data-level="4.9" data-path="the-linear-model.html"><a href="the-linear-model.html#major-points"><i class="fa fa-check"></i><b>4.9</b> Major points</a></li>
<li class="chapter" data-level="4.10" data-path="the-linear-model.html"><a href="the-linear-model.html#extra-credit-understanding-linear-models-through-the-notation"><i class="fa fa-check"></i><b>4.10</b> Extra credit: Understanding linear models through the notation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>5</b> R Fundamentals</a><ul>
<li class="chapter" data-level="5.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#about-this-chapter"><i class="fa fa-check"></i><b>5.1</b> About this chapter</a></li>
<li class="chapter" data-level="5.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#working-with-r"><i class="fa fa-check"></i><b>5.2</b> Working with R</a></li>
<li class="chapter" data-level="5.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#variables"><i class="fa fa-check"></i><b>5.3</b> Variables</a><ul>
<li class="chapter" data-level="5.3.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#using-objects-and-functions"><i class="fa fa-check"></i><b>5.3.1</b> Using objects and functions</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#dataframes"><i class="fa fa-check"></i><b>5.4</b> Dataframes</a></li>
<li class="chapter" data-level="5.5" data-path="r-fundamentals.html"><a href="r-fundamentals.html#packages"><i class="fa fa-check"></i><b>5.5</b> Packages</a></li>
<li class="chapter" data-level="5.6" data-path="r-fundamentals.html"><a href="r-fundamentals.html#using-r-help"><i class="fa fa-check"></i><b>5.6</b> Using R Help</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html"><i class="fa fa-check"></i><b>6</b> <span class="math inline">\(t\)</span>-tests and linear models</a><ul>
<li class="chapter" data-level="6.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#recap"><i class="fa fa-check"></i><b>6.1</b> Recap</a><ul>
<li class="chapter" data-level="6.1.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-slope-of-the-model-again"><i class="fa fa-check"></i><b>6.1.1</b> The slope of the model again</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#using-two-different-samples-instead-of-a-continuous-x-variable"><i class="fa fa-check"></i><b>6.2</b> Using two different samples instead of a continuous <span class="math inline">\(x\)</span> variable</a></li>
<li class="chapter" data-level="6.3" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-plantgrowth-data"><i class="fa fa-check"></i><b>6.3</b> The PlantGrowth data</a></li>
<li class="chapter" data-level="6.4" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#a-linear-model-with-a-categoric-x-axis"><i class="fa fa-check"></i><b>6.4</b> A linear model with a categoric <span class="math inline">\(x\)</span>-axis</a></li>
<li class="chapter" data-level="6.5" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#using-the-statistics-of-the-linear-model-to-test-for-differences"><i class="fa fa-check"></i><b>6.5</b> Using the statistics of the linear model to test for differences</a><ul>
<li class="chapter" data-level="6.5.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-coefficient-and-the-mean-difference-between-groups-are-equivalent"><i class="fa fa-check"></i><b>6.5.1</b> The coefficient and the mean difference between groups are equivalent</a></li>
<li class="chapter" data-level="6.5.2" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-p-value-of-the-co-efficient-tests-the-same-thing-as-a-t-test"><i class="fa fa-check"></i><b>6.5.2</b> The <span class="math inline">\(p\)</span>-value of the co-efficient tests the same thing as a <span class="math inline">\(t\)</span>-test</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#summary"><i class="fa fa-check"></i><b>6.6</b> Summary</a></li>
<li class="chapter" data-level="6.7" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#but-wasnt-the-t-test-just-easier"><i class="fa fa-check"></i><b>6.7</b> But wasn’t the <span class="math inline">\(t\)</span>-test just easier?</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html"><i class="fa fa-check"></i><b>7</b> ANOVA and linear models</a><ul>
<li class="chapter" data-level="7.1" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#comparing-groups-in-a-single-variable"><i class="fa fa-check"></i><b>7.1</b> Comparing groups in a single variable</a></li>
<li class="chapter" data-level="7.2" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#one-way-comparisons---groups-in-a-single-variable"><i class="fa fa-check"></i><b>7.2</b> One-Way comparisons - groups in a single variable</a></li>
<li class="chapter" data-level="7.3" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#two-way-comparisons---groups-in-multiple-variables"><i class="fa fa-check"></i><b>7.3</b> Two-Way comparisons - groups in multiple variables</a></li>
<li class="chapter" data-level="7.4" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#interactions-between-variables"><i class="fa fa-check"></i><b>7.4</b> Interactions between variables</a><ul>
<li class="chapter" data-level="7.4.1" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#analysing-and-modelling-an-interaction-effect"><i class="fa fa-check"></i><b>7.4.1</b> Analysing and modelling an interaction effect</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#doing-all-pairwise-interactions"><i class="fa fa-check"></i><b>7.5</b> Doing all pairwise interactions</a></li>
<li class="chapter" data-level="7.6" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#summary"><i class="fa fa-check"></i><b>7.6</b> Summary</a></li>
<li class="chapter" data-level="7.7" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#extra-credit-anova-model-level-p-and-as-a-hypothesis-test"><i class="fa fa-check"></i><b>7.7</b> Extra Credit: ANOVA model-level <span class="math inline">\(p\)</span> and as a hypothesis test</a></li>
<li class="chapter" data-level="7.8" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#extra-credit-testing-specific-interactions"><i class="fa fa-check"></i><b>7.8</b> Extra Credit: Testing specific interactions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html"><i class="fa fa-check"></i><b>8</b> Non-parametric tests and linear models</a><ul>
<li class="chapter" data-level="8.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#common-misrepresentations-of-discrete-data"><i class="fa fa-check"></i><b>8.1</b> Common misrepresentations of discrete data</a><ul>
<li class="chapter" data-level="8.1.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#twisting-names-into-numbers-confuses-the-mind"><i class="fa fa-check"></i><b>8.1.1</b> Twisting names into numbers confuses the mind</a></li>
<li class="chapter" data-level="8.1.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#this-does-not-mean-what-i-think-you-think-it-means"><i class="fa fa-check"></i><b>8.1.2</b> This does not mean what I think you think it means</a></li>
<li class="chapter" data-level="8.1.3" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#build-a-strong-foundation"><i class="fa fa-check"></i><b>8.1.3</b> Build a strong foundation</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#setting-type-properly"><i class="fa fa-check"></i><b>8.2</b> Setting type properly</a><ul>
<li class="chapter" data-level="8.2.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#setting-type-with-read_csv"><i class="fa fa-check"></i><b>8.2.1</b> Setting type with <code>read_csv()</code></a></li>
<li class="chapter" data-level="8.2.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#setting-type-post-hoc-with-transmute"><i class="fa fa-check"></i><b>8.2.2</b> Setting type <em>post hoc</em> with <code>transmute()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#plots-with-categoric-x-and-y-axis"><i class="fa fa-check"></i><b>8.3</b> Plots with categoric <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axis</a></li>
<li class="chapter" data-level="8.4" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#linear-models-and-a-categoric-y-variable"><i class="fa fa-check"></i><b>8.4</b> Linear models and a categoric <span class="math inline">\(y\)</span> variable</a><ul>
<li class="chapter" data-level="8.4.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#ordered-categoric-response-variables"><i class="fa fa-check"></i><b>8.4.1</b> Ordered categoric response variables</a></li>
<li class="chapter" data-level="8.4.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#making-linear-models-with-ranked-data"><i class="fa fa-check"></i><b>8.4.2</b> Making linear models with ranked data</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#hypothesis-tests"><i class="fa fa-check"></i><b>8.5</b> Hypothesis Tests</a><ul>
<li class="chapter" data-level="8.5.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#but-arent-the-tests-just-easier"><i class="fa fa-check"></i><b>8.5.1</b> But aren’t the tests just easier?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html"><i class="fa fa-check"></i><b>9</b> <span class="math inline">\(\chi ^2\)</span> tests and linear models</a><ul>
<li class="chapter" data-level="9.1" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#the-problem-with-unordered-response-data"><i class="fa fa-check"></i><b>9.1</b> The problem with unordered response data</a></li>
<li class="chapter" data-level="9.2" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#we-have-to-compare-models-not-groups."><i class="fa fa-check"></i><b>9.2</b> We have to compare models, not groups.</a></li>
<li class="chapter" data-level="9.3" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#the-chi2-test"><i class="fa fa-check"></i><b>9.3</b> The <span class="math inline">\(\chi^2\)</span> test</a><ul>
<li class="chapter" data-level="9.3.1" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#performing-the-test"><i class="fa fa-check"></i><b>9.3.1</b> Performing the test</a></li>
<li class="chapter" data-level="9.3.2" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#more-than-one-variable"><i class="fa fa-check"></i><b>9.3.2</b> More than one variable</a></li>
<li class="chapter" data-level="9.3.3" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#more-than-one-pairwise-comparison"><i class="fa fa-check"></i><b>9.3.3</b> More than one pairwise comparison</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#summary"><i class="fa fa-check"></i><b>9.4</b> Summary</a></li>
<li class="chapter" data-level="9.5" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#plot-ideas-for-categoric-and-count-data"><i class="fa fa-check"></i><b>9.5</b> Plot ideas for categoric and count data</a><ul>
<li class="chapter" data-level="9.5.1" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#balloon-plot"><i class="fa fa-check"></i><b>9.5.1</b> Balloon plot</a></li>
<li class="chapter" data-level="9.5.2" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#heatmap"><i class="fa fa-check"></i><b>9.5.2</b> Heatmap</a></li>
<li class="chapter" data-level="9.5.3" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#stacked-bar"><i class="fa fa-check"></i><b>9.5.3</b> Stacked bar</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html"><i class="fa fa-check"></i><b>10</b> More fun with linear models</a><ul>
<li class="chapter" data-level="10.1" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#assessing-a-linear-model"><i class="fa fa-check"></i><b>10.1</b> Assessing a linear model</a><ul>
<li class="chapter" data-level="10.1.1" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#the-terror-of-normality"><i class="fa fa-check"></i><b>10.1.1</b> The terror of normality</a></li>
<li class="chapter" data-level="10.1.2" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#checking-whether-the-mean-is-a-good-summary"><i class="fa fa-check"></i><b>10.1.2</b> Checking whether the mean is a good summary</a></li>
<li class="chapter" data-level="10.1.3" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#spotting-a-good-fit-to-the-data"><i class="fa fa-check"></i><b>10.1.3</b> Spotting a good fit to the data</a></li>
<li class="chapter" data-level="10.1.4" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#checking-qq-plots-for-a-normal-distribution"><i class="fa fa-check"></i><b>10.1.4</b> Checking qq-plots for a normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#predictions"><i class="fa fa-check"></i><b>10.2</b> Predictions</a><ul>
<li class="chapter" data-level="10.2.1" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#intuition-on-prediction-from-continuous-variables"><i class="fa fa-check"></i><b>10.2.1</b> Intuition on prediction from continuous variables</a></li>
<li class="chapter" data-level="10.2.2" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#intuition-on-prediction-with-categoric-variables"><i class="fa fa-check"></i><b>10.2.2</b> Intuition on prediction with categoric variables</a></li>
<li class="chapter" data-level="10.2.3" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#using-predictions-in-more-complicated-models"><i class="fa fa-check"></i><b>10.2.3</b> Using predictions in more complicated models</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#generalized-linear-models"><i class="fa fa-check"></i><b>10.3</b> Generalized Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Understanding Statistical Thinking With Linear Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anova-and-linear-models" class="section level1">
<h1><span class="header-section-number">Topic 7</span> ANOVA and linear models</h1>
<ol style="list-style-type: decimal">
<li>Questions</li>
</ol>
<ul>
<li>How can we compare many variables and factor levels</li>
<li>How can we check for interactions between treatments</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Objectives</li>
</ol>
<ul>
<li>Learn how to specify more complicated linear models</li>
<li>Understand how ANOVA works with a linear model</li>
<li>Understand how to spot interactions from plots</li>
<li>Learn how to deal with interactions in ANOVA</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Keypoints</li>
</ol>
<ul>
<li>Working with many variables is the same as working with just one</li>
<li>ANOVA is a tool for specifying comparisons between variables in linear models</li>
<li>We must take care to account for interactions between the variables</li>
</ul>
<div id="comparing-groups-in-a-single-variable" class="section level2">
<h2><span class="header-section-number">7.1</span> Comparing groups in a single variable</h2>
<p>In the last section we looked at using the linear model to compare two groups, in this section we’ll look at using it to compare more than two. One thing to note is that (for now) we’re still working with only one explanatory variable, the groups we are talking about are basically different values that the one variable can take. In the <code>PlantGrowth</code> data the variable is called <code>group</code> and the values it takes are <code>ctrl</code>, <code>trt1</code> and <code>trt2</code>.</p>
<p>You’ll be pleased to know this is where the pay off comes. Any number of groups (and later any number of variables) is no more complicated than the two we’ve already done.</p>
<p>We can visualise the process as simply being a case where we have more than one line to examine. Consider this figure, here we draw the categorical scatter plot and draw lines joining all the different group means that indicate the different comparisons we might choose to do with these data.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="anova-and-linear-models.html#cb68-1"></a><span class="kw">library</span>(itssl)</span>
<span id="cb68-2"><a href="anova-and-linear-models.html#cb68-2"></a><span class="kw">its_multi_category_with_lines_time</span>()</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p>So we’ll need to know how to read the linear model for each of the given lines.
Let’s jump in and work through that. First let’s build a linear model with a variable with multiple groups.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="anova-and-linear-models.html#cb69-1"></a>model &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> PlantGrowth)</span>
<span id="cb69-2"><a href="anova-and-linear-models.html#cb69-2"></a><span class="kw">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ group, data = PlantGrowth)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0710 -0.4180 -0.0060  0.2627  1.3690 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.0320     0.1971  25.527   &lt;2e-16 ***
## grouptrt1    -0.3710     0.2788  -1.331   0.1944    
## grouptrt2     0.4940     0.2788   1.772   0.0877 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6234 on 27 degrees of freedom
## Multiple R-squared:  0.2641,	Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
<p>Great! so we handle the extra levels of the variable nearly perfectly. There are two lines of coefficient results, the first showing the gradient between the <code>ctrl</code> and <code>trt1</code> and the second showing the gradient between <code>ctrl</code> and <code>trt2</code>. The <code>ctrl</code> data has clearly been used as a common reference - this is the default design in the function, the first group in the data becomes the common reference. Here we get away with it, as we do want the first level to be the common reference. When you need to change the order, you can set the reference level explicitly.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="anova-and-linear-models.html#cb71-1"></a>df &lt;-<span class="st"> </span>PlantGrowth</span>
<span id="cb71-2"><a href="anova-and-linear-models.html#cb71-2"></a>df<span class="op">$</span>group&lt;-<span class="st"> </span><span class="kw">relevel</span>(df<span class="op">$</span>group, <span class="dt">ref=</span><span class="st">&quot;trt2&quot;</span>)</span>
<span id="cb71-3"><a href="anova-and-linear-models.html#cb71-3"></a>model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span>group  , <span class="dt">data =</span> df,)</span>
<span id="cb71-4"><a href="anova-and-linear-models.html#cb71-4"></a><span class="kw">summary</span>(model2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ group, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0710 -0.4180 -0.0060  0.2627  1.3690 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.5260     0.1971  28.032  &lt; 2e-16 ***
## groupctrl    -0.4940     0.2788  -1.772  0.08768 .  
## grouptrt1    -0.8650     0.2788  -3.103  0.00446 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6234 on 27 degrees of freedom
## Multiple R-squared:  0.2641,	Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
<p>And now we see the <code>trt2</code> as common reference against the <code>ctrl</code> and <code>trt1</code> groups.</p>
<p>In these data only <code>trt2 vs trt1</code> appears to be significant according to the linear model <code>model2</code> but we did need to create two models to do this, which is a bit of a statistical mess. If this seems longwinded or illogical, then that’s fair. The two models have the same data and specification so should have the same results in - it was really just the way we were ordering things in the data that was different. The real problem is just one of bookkeeping.</p>
<p>The linear models are rich and not all the comparisons that can be done with them can easily be written in <code>summary(model)</code>. To answer specific questions from an analysis technique for getting specific comparisons (or contrasts in the statistics jargon) from linear models has been invented, that technique is called ANOVA (Analysis of Variance).</p>

<div class="sidenote">
I know, I gave you the impression that we would be using linear models and not ANOVAs, but the thing is, ANOVAs have always been based on linear models. In a way ANOVA isn’t a test of its own, not in the way we think of <span class="math inline">\(t\)</span>-tests or <span class="math inline">\(\chi\)</span>-squared tests. ANOVA is plural, they are a set of tools for pulling comparisons straight out of linear models in the best way. So that’s another great reason for having bothered to understand something of how linear models work.
</div>

</div>
<div id="one-way-comparisons---groups-in-a-single-variable" class="section level2">
<h2><span class="header-section-number">7.2</span> One-Way comparisons - groups in a single variable</h2>
<p>The situation where we have just one variable is called a ‘One-Way’ ANOVA.</p>
<p>Now that we have a solid way of thinking about contrasts as the slope between the categories, we can think of ANOVA as a tool for pulling out the significances in the best way. All we have to do is learn how to specify the contrasts for ANOVA.</p>
<p>Every time we do ANOVA we need a model to feed into it. Here’s the most common way ANOVA is done in R, with the <code>aov()</code> and <code>TukeyHSD()</code> functions, you’ve probably seen this before.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="anova-and-linear-models.html#cb73-1"></a>ano &lt;-<span class="st"> </span><span class="kw">aov</span>(model)</span>
<span id="cb73-2"><a href="anova-and-linear-models.html#cb73-2"></a><span class="kw">TukeyHSD</span>(ano)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = model)
## 
## $group
##             diff        lwr       upr     p adj
## trt1-ctrl -0.371 -1.0622161 0.3202161 0.3908711
## trt2-ctrl  0.494 -0.1972161 1.1852161 0.1979960
## trt2-trt1  0.865  0.1737839 1.5562161 0.0120064</code></pre>
<p>It seems to do the job, though the ‘flavour’ of ANOVA it does is sometimes limited and applies only when the standard assumptions of ANOVA are met.</p>

<div class="sidenote">
<p>A scary thing that statisticians often say is that such-and-such a method is only applicable when certain assumptions are met. This can make scientists nervy about applying any methods in case it is wrong. I would like to encourage you to relax about this aspect. Most statistical tests are pretty robust to against violations, and if anything tend to get more conservative (IE, generate fewer significant results) in these cases. There are a few assumptions and even a few types of data that we need to be aware of. I dedicate some space in the last chapter to understanding where these trip-ups might happen.</p>
</div>

<p>A better alternative than the quick and dirty ANOVA approach above (in the sense of flexibility for the user) is the <code>multcomp</code> package function <code>glht()</code> (general linear model hypothesis test), which is more flexible with respect to which designs and contrasts you can get out, at the expense of being a little more complicated. The basic case is straightforward though.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="anova-and-linear-models.html#cb75-1"></a><span class="kw">library</span>(multcomp)</span>
<span id="cb75-2"><a href="anova-and-linear-models.html#cb75-2"></a>tested &lt;-<span class="st"> </span><span class="kw">glht</span>(model, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">group =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb75-3"><a href="anova-and-linear-models.html#cb75-3"></a><span class="kw">summary</span>(tested)</span></code></pre></div>
<pre><code>## 
## 	 Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = weight ~ group, data = PlantGrowth)
## 
## Linear Hypotheses:
##                  Estimate Std. Error t value Pr(&gt;|t|)  
## trt1 - ctrl == 0  -0.3710     0.2788  -1.331    0.391  
## trt2 - ctrl == 0   0.4940     0.2788   1.772    0.198  
## trt2 - trt1 == 0   0.8650     0.2788   3.103    0.012 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>The <code>linfct</code> option just takes a specification of the things to be tested, and the <code>mcp()</code> function is a helper that generates the comparison based on a text description, here that the variable <code>group</code> should be analysed by ‘Tukey’.</p>
<p>By printing the summary we see the contrast hypotheses writ explicitly (e.g. the difference between <code>ctrl</code> and <code>trt1</code> is 0) and the conclusions: there is no evidence to suggest either treatment is different from the control, but the difference we observe between the <code>trt1</code> and <code>trt2</code> occurs by chance only about 1.2 percent of the time, so is deemed ‘significant’.</p>
<p>And that’s it! A properly done and specified use of the linear model and a subsequent ANOVA with Tukey’s <em>post hoc</em> used to determine differences.</p>
<p>We’ll see more of how to use <code>glht()</code> as we go.</p>
</div>
<div id="two-way-comparisons---groups-in-multiple-variables" class="section level2">
<h2><span class="header-section-number">7.3</span> Two-Way comparisons - groups in multiple variables</h2>
<p>Often we’ll have experimental data where we have more than one explanatory variable, for example, <code>compost</code> and <code>fertiliser</code> and want to know the effects of each on a response variable like <code>yield</code>. Where you have two variables, it’s called a Two-Way ANOVA.</p>
<p>Two-Way comparisons are pretty similar in practice to One-Way comparisons. So similar in fact that you’re going to jump in and try one, without any further instruction</p>

<div class="task">
<ol style="list-style-type: decimal">
<li>Use the function <code>its_compost_time()</code> to load some data on the effects of changing compost type and a supplement on plant size.</li>
<li>Build a linear model specifying that size is related to the two other explanatory variables. We haven’t explicitly discussed the syntax for two variables, but in the linear model a extra variables is added with ‘+’, thats how its done in R e.g. <code>lm(y ~ a + b + c)</code>. Inspect the model.</li>
<li>Carry out Tukey’s to test the hypotheses i) that the true difference in means between Formula X1 and X2 is 0, and ii) that the true difference in means between John Innes #1 and #2 is 0.</li>
</ol>
</div>

</div>
<div id="interactions-between-variables" class="section level2">
<h2><span class="header-section-number">7.4</span> Interactions between variables</h2>
<p>Working with multiple variables is complicated over the single case as we have the possibility of an interaction between the variables to consider. That is to say that the response in an experiment may be stronger under conditions <code>a and b</code> than in <code>a</code> or <code>b</code> alone whether <code>a</code> or <code>b</code> alone is greater than a <code>control</code> or not. We can visualise this as straight lines like in the diagrams below.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="anova-and-linear-models.html#cb77-1"></a><span class="kw">its_interaction_example_time</span>()</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<p>We can see the effect of interaction quite clearly in the two types of data, whenever <code>a &amp; b</code> is used then we have greater responses, either in greater means or in steeper gradients.</p>
<p>Let’s work through an example that highlights how we identify and investigate this with linear models and ANOVAs. Here’s some data on reported enjoyment of some food, with different condiments added</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="anova-and-linear-models.html#cb78-1"></a>food &lt;-<span class="st"> </span><span class="kw">its_food_data_time</span>()</span>
<span id="cb78-2"><a href="anova-and-linear-models.html#cb78-2"></a><span class="co">#look at specific rows 1,21,41,61</span></span>
<span id="cb78-3"><a href="anova-and-linear-models.html#cb78-3"></a>food[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">21</span>,<span class="dv">41</span>,<span class="dv">61</span>),]                                      </span></code></pre></div>
<pre><code>##              Food Condiment Enjoyment
## 1  Tortilla Chips   Hummous  87.19762
## 21 Tortilla Chips       Jam  55.72871
## 41       Porridge   Hummous  57.22117
## 61       Porridge       Jam  91.89820</code></pre>
<p>Looking at those in the way we have already - each variable individually - then we would generate the following plots and lines to examine.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="anova-and-linear-models.html#cb80-1"></a><span class="kw">its_food_plot_time</span>()</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>Without rushing ahead to do the modelling, we see that hummous has a slightly greater effect on enjoyment than jam, whereas the enjoyment of the two food types is much more similar. So without a hypothesis test the dangerously thin conclusion would be ‘use hummous to enhance your enjoyment of Porridge or Tortilla Chips’. We might be suspect of this conclusion not only because it seems not to line up with our intuitive sense of what’s going on, but also because of those strange splits in the data. Look within each column and you can see that there is a definite clustering that is not a good sign, we possibly don’t have a good specification of our data here.</p>
<p>Let’s see what the model says, in specifying the second variable can be added with a <code>+</code> as</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="anova-and-linear-models.html#cb81-1"></a>model_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(Enjoyment <span class="op">~</span><span class="st"> </span>Food <span class="op">+</span><span class="st"> </span>Condiment, <span class="dt">data =</span> food)</span>
<span id="cb81-2"><a href="anova-and-linear-models.html#cb81-2"></a><span class="kw">summary</span>(model_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Enjoyment ~ Food + Condiment, data = food)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -21.593 -15.526  -1.348  14.832  25.822 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         75.3978     3.0674  24.580   &lt;2e-16 ***
## FoodTortilla Chips   0.3384     3.5419   0.096    0.924    
## CondimentJam        -0.9693     3.5419  -0.274    0.785    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 15.84 on 77 degrees of freedom
## Multiple R-squared:  0.00109,	Adjusted R-squared:  -0.02486 
## F-statistic: 0.04201 on 2 and 77 DF,  p-value: 0.9589</code></pre>
<p>The summary isn’t promising, it looks like neither is significant. Let’s do the ANOVA and get a clearer view.</p>
<p>The call to <code>glht()</code> is a bit more complicated than before, but not much</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="anova-and-linear-models.html#cb83-1"></a><span class="kw">summary</span>(<span class="kw">glht</span>(model_<span class="dv">1</span>, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">Food =</span> <span class="st">&quot;Tukey&quot;</span>, <span class="dt">Condiment =</span> <span class="st">&quot;Tukey&quot;</span>) ) )</span></code></pre></div>
<pre><code>## 
## 	 Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = Enjoyment ~ Food + Condiment, data = food)
## 
## Linear Hypotheses:
##                                      Estimate Std. Error t value Pr(&gt;|t|)
## Food: Tortilla Chips - Porridge == 0   0.3384     3.5419   0.096    0.994
## Condiment: Jam - Hummous == 0         -0.9693     3.5419  -0.274    0.954
## (Adjusted p values reported -- single-step method)</code></pre>
<p>Neither factor seems to be significant. Hmm. This seems like a slightly strange conclusion - and it is. The presence of two variables is confusing this approach. Look at what we get if we split the data by the two variables at once.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="anova-and-linear-models.html#cb85-1"></a><span class="kw">its_food_two_ways_time</span>()</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>Ok! That’s very different and very much clearer. The enjoyment is very much dependent on the combination of food and condiment. This is a classic case of interaction between variables. You get results that are conditional on the combined values of the variables.</p>

<div class="sidenote">
The cross-over of the lines is a visual diagnostic of the presence of an interaction effect.
</div>

<div id="analysing-and-modelling-an-interaction-effect" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Analysing and modelling an interaction effect</h3>
<p>The interaction effect should be checked for in the linear model. It is quite easy to check for and requires a slight extension to syntax. An interaction term can be specified with the <code>:</code>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="anova-and-linear-models.html#cb86-1"></a>interaction_model &lt;-<span class="st"> </span><span class="kw">lm</span>(Enjoyment <span class="op">~</span><span class="st"> </span>Food <span class="op">+</span><span class="st"> </span>Condiment <span class="op">+</span><span class="st"> </span>Food<span class="op">:</span>Condiment, <span class="dt">data =</span> food)</span></code></pre></div>
<p>(there is also a short hand that allows the whole thing to be specified in one term <code>*</code>, which is used like <code>lm(Enjoyment ~ Food * Condiment, data=food)</code>)</p>
<p>and when we print the <code>summary()</code> we get the book-keeping issue of not all the results we want to see being immediately available, but we can see the usual stuff.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="anova-and-linear-models.html#cb87-1"></a><span class="kw">summary</span>(interaction_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Enjoyment ~ Food + Condiment + Food:Condiment, data = food)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.9463  -2.8645  -0.2551   2.7201  10.8500 
## 
## Coefficients:
##                                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                      60.4259     0.9553   63.25   &lt;2e-16 ***
## FoodTortilla Chips               30.2822     1.3510   22.41   &lt;2e-16 ***
## CondimentJam                     28.9745     1.3510   21.45   &lt;2e-16 ***
## FoodTortilla Chips:CondimentJam -59.8876     1.9106  -31.34   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.272 on 76 degrees of freedom
## Multiple R-squared:  0.9283,	Adjusted R-squared:  0.9254 
## F-statistic: 327.9 on 3 and 76 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>This seems much more like what we expect from the graph, significance everywhere! Basically what the summary is saying is that the Food, Condiment and both together have an effect on the reported enjoyment. This is a bit confusing, because the previous model said that the main effects (Food, Condiment) <em>weren’t</em> significant. The issue is the way the two models separate the data. The point is that in the second model the significance for the main effect is reliant on the interaction, so we can’t generalise to say that Food or Condiment alone has significant effect on enjoyment. We must ignore these main effects in our interpretation.</p>
<p>But are the contrasts presented here really all the ones we’re interested in? These seem a bit generic and hard to interpret. This is generally the case so we need to know how to extract the ones we’re interested in.</p>
<p>In our linear model way of thinking this means which lines do we want to test for zero slopes? There can be many lines we could imagine depending on how we decide to group the data and the number of variables that we have. Let’s define which we’ll look at before we begin.</p>
<p>Let’s see whether food alone or condiment alone has an effect. This would be like the first situation we looked at,</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="anova-and-linear-models.html#cb89-1"></a><span class="kw">its_food_plot_time</span>()</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>in the way that the output we’ve seen so far has it, this would be</p>
<blockquote>
<p>Porridge - Tortilla Chips == 0</p>
<p>Hummous - Jam == 0</p>
</blockquote>
<p>Let’s also see whether <code>food * condiment</code> has an effect. This would be like the interaction situation.</p>
<blockquote>
<p>Porridge:Jam - Tortilla Chips:Jam == 0</p>
<p>Porridge:Hummous - Tortilla Chips:Hummous == 0</p>
</blockquote>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="anova-and-linear-models.html#cb90-1"></a><span class="kw">its_food_two_ways_time</span>()</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p>So we have four lines of interest to look at - four contrasts.</p>
<p>For the two main non-interaction effects we could think to look at these as we’ve done before, using the <code>mcp()</code> function with the <code>interaction_model</code> with the explicit interaction in it, like this</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="anova-and-linear-models.html#cb91-1"></a><span class="kw">summary</span>(</span>
<span id="cb91-2"><a href="anova-and-linear-models.html#cb91-2"></a>  <span class="kw">glht</span>(interaction_model, <span class="dt">linfct =</span> <span class="kw">mcp</span>(</span>
<span id="cb91-3"><a href="anova-and-linear-models.html#cb91-3"></a>    <span class="dt">Food =</span> <span class="st">&quot;Tukey&quot;</span>,</span>
<span id="cb91-4"><a href="anova-and-linear-models.html#cb91-4"></a>    <span class="dt">Condiment =</span> <span class="st">&quot;Tukey&quot;</span></span>
<span id="cb91-5"><a href="anova-and-linear-models.html#cb91-5"></a>  ))</span>
<span id="cb91-6"><a href="anova-and-linear-models.html#cb91-6"></a>)</span></code></pre></div>
<pre><code>## Warning in mcp2matrix(model, linfct = linfct): covariate interactions found --
## default contrast might be inappropriate

## Warning in mcp2matrix(model, linfct = linfct): covariate interactions found --
## default contrast might be inappropriate</code></pre>
<pre><code>## 
## 	 Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = Enjoyment ~ Food + Condiment + Food:Condiment, data = food)
## 
## Linear Hypotheses:
##                                      Estimate Std. Error t value Pr(&gt;|t|)    
## Food: Tortilla Chips - Porridge == 0   30.282      1.351   22.41   &lt;1e-10 ***
## Condiment: Jam - Hummous == 0          28.974      1.351   21.45   &lt;1e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>This gives a result, but actually throws up a warning. Since we have an interaction term in our model, we have a complication. The <code>glht()</code> function has spotted that there are interacting terms and potential for confounding and the <span class="math inline">\(p\)</span>-values are therefore a bit suspect without being a bit more careful. We need to take account of the interaction as a term of its own in our hypothesis tests. Annoyingly, this isn’t an easy thing to specify in the <code>glht()</code> function and the easiest way in practice is to just do all the comparisons.</p>

<div class="sidenote">
The reason that the warnings are thrown in the interaction model is to do with an ANOVA internal object called the Contrasts Matrix, which specifies the contrasts and is used in the linear algebra of the ANOVA and Tukey’s method. The Contrast Matrix is basically a grid with the different samples and contrasts as the rows and columns with a load of ones and zeroes in it. For Tukey’s method to work the Contrast Matrix should be ‘orthogonal’, which roughly means symmetric around a certain axis. When we get the interaction term in the model we lose the orthogonality in the Contrast Matrix and Tukey’s method stops working well. The orthogonality is one of the assumptions that statisticians talk about. It is possible to set up different Contrast Matrices and there are methods for getting significance for non-orthogonal ones, however that does take us a bit too far into theory. For most purposes, except for those with very large numbers of variables it is convenient to use the alternative method below.
</div>

</div>
</div>
<div id="doing-all-pairwise-interactions" class="section level2">
<h2><span class="header-section-number">7.5</span> Doing all pairwise interactions</h2>
<p>Although we’re interested in only two specific interactions, usually it’s easier to do all pairwise comparisons in one step, as we don’t often have so many interacting variables that it gets unwieldy. To do this we must add an interaction column to our data and model that. The <code>interaction()</code> function is built for just this reason and allows us to add an interaction column directly from existing data.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="anova-and-linear-models.html#cb94-1"></a>food_<span class="dv">2</span> &lt;-<span class="st"> </span>food <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">FoodCondiment =</span> <span class="kw">interaction</span>(Food, Condiment))</span>
<span id="cb94-2"><a href="anova-and-linear-models.html#cb94-2"></a>knitr<span class="op">::</span><span class="kw">kable</span>( food_<span class="dv">2</span>[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">21</span>,<span class="dv">41</span>,<span class="dv">61</span>),] , <span class="dt">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Food</th>
<th align="center">Condiment</th>
<th align="center">Enjoyment</th>
<th align="center">FoodCondiment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="center">Tortilla Chips</td>
<td align="center">Hummous</td>
<td align="center">87.19762</td>
<td align="center">Tortilla Chips.Hummous</td>
</tr>
<tr class="even">
<td align="left">21</td>
<td align="center">Tortilla Chips</td>
<td align="center">Jam</td>
<td align="center">55.72871</td>
<td align="center">Tortilla Chips.Jam</td>
</tr>
<tr class="odd">
<td align="left">41</td>
<td align="center">Porridge</td>
<td align="center">Hummous</td>
<td align="center">57.22117</td>
<td align="center">Porridge.Hummous</td>
</tr>
<tr class="even">
<td align="left">61</td>
<td align="center">Porridge</td>
<td align="center">Jam</td>
<td align="center">91.89820</td>
<td align="center">Porridge.Jam</td>
</tr>
</tbody>
</table>
<p>We can see that all we’ve done is add a column that describes the interaction. We can use this in the place of the individual variables as before and now don’t need to explicitly mention the interaction in the specification because it is modelled implicitly in the new column. That means our model looks like this</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="anova-and-linear-models.html#cb95-1"></a>interaction_model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(Enjoyment <span class="op">~</span><span class="st"> </span>FoodCondiment, <span class="dt">data =</span> food_<span class="dv">2</span>)</span></code></pre></div>
<p>To do the contrasts we can use the single interaction column as the target of Tukey.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="anova-and-linear-models.html#cb96-1"></a><span class="kw">summary</span>(</span>
<span id="cb96-2"><a href="anova-and-linear-models.html#cb96-2"></a>  <span class="kw">glht</span>(interaction_model2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">FoodCondiment =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb96-3"><a href="anova-and-linear-models.html#cb96-3"></a>  )</span></code></pre></div>
<pre><code>## 
## 	 Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = Enjoyment ~ FoodCondiment, data = food_2)
## 
## Linear Hypotheses:
##                                                  Estimate Std. Error t value
## Tortilla Chips.Hummous - Porridge.Hummous == 0     30.282      1.351  22.414
## Porridge.Jam - Porridge.Hummous == 0               28.974      1.351  21.446
## Tortilla Chips.Jam - Porridge.Hummous == 0         -0.631      1.351  -0.467
## Porridge.Jam - Tortilla Chips.Hummous == 0         -1.308      1.351  -0.968
## Tortilla Chips.Jam - Tortilla Chips.Hummous == 0  -30.913      1.351 -22.881
## Tortilla Chips.Jam - Porridge.Jam == 0            -29.605      1.351 -21.913
##                                                  Pr(&gt;|t|)    
## Tortilla Chips.Hummous - Porridge.Hummous == 0     &lt;1e-05 ***
## Porridge.Jam - Porridge.Hummous == 0               &lt;1e-05 ***
## Tortilla Chips.Jam - Porridge.Hummous == 0          0.966    
## Porridge.Jam - Tortilla Chips.Hummous == 0          0.768    
## Tortilla Chips.Jam - Tortilla Chips.Hummous == 0   &lt;1e-05 ***
## Tortilla Chips.Jam - Porridge.Jam == 0             &lt;1e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>We can see all possible interaction groupings and lines, without any warnings. We can see that the significances make good sense. The Porridge and Jam is no more enjoyable than the Tortilla Chips and Hummous, the Porridge and Hummous is no more enjoyable than the Tortilla Chips and Jam and all the other match and mismatch food and condiments are as we might expect from this very obviously loaded example.</p>
<p>We said we wanted to look specifically at the interaction between the Porridge with Jam and Tortilla Chips with Jam - we can see that there is a significant difference in enjoyment, about 29 points. Similarly Porridge with Hummous is less enjoyable than Tortilla Chips with Hummous, by about 30 points.</p>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">7.6</span> Summary</h2>
<p>We’ve looked at how to use linear models to think about differences between lots of categories and at what it means for variables to be interacting. We learned that ANOVA is inherently a test based on a linear model that is designed to do all comparisons at once and we learned how to carry the ANOVAs out having built the proper linear model for cases with and without interactions. We know all we need to use R to perform ANOVAs with linear models - which always use linear models anyway.</p>
</div>
<div id="extra-credit-anova-model-level-p-and-as-a-hypothesis-test" class="section level2">
<h2><span class="header-section-number">7.7</span> Extra Credit: ANOVA model-level <span class="math inline">\(p\)</span> and as a hypothesis test</h2>
<p>Recall that when we introduced linear models we looked at the statistics of the coefficients (the column <span class="math inline">\(Pr(&gt;|t|)\)</span> in the coefficient block of the summary) <em>and</em> the statistics of the whole model, the <span class="math inline">\(p\)</span>-value at the end.</p>
<p>When we did the simple linear model as an alternative of the <span class="math inline">\(t\)</span>-test, then these two <span class="math inline">\(p\)</span>-values were the same - this is because the model then only had one coefficient, so the <span class="math inline">\(p\)</span> of that coefficient was the overall <span class="math inline">\(p\)</span>. With more than one coefficient, then the overall model score is made up differently. The overall model can be significant, whereas the individual variables/groups/coefficient within may not be. That’s what we saw when we looked at the <code>PlantGrowth</code> data.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="anova-and-linear-models.html#cb98-1"></a><span class="kw">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ group, data = PlantGrowth)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0710 -0.4180 -0.0060  0.2627  1.3690 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.0320     0.1971  25.527   &lt;2e-16 ***
## grouptrt1    -0.3710     0.2788  -1.331   0.1944    
## grouptrt2     0.4940     0.2788   1.772   0.0877 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6234 on 27 degrees of freedom
## Multiple R-squared:  0.2641,	Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
<p>None of the reported variable/group/coefficient values are significant but the model level <span class="math inline">\(p\)</span> is. This indicates that one of the groups is significant. This is because the ANOVA as a test tests the hypothesis that all lines between groups have slopes of zero. When one line isn’t likely to have a zero slope the model <span class="math inline">\(p\)</span> is low</p>
<p>In terms of a formal hypothesis test what we’re asking amounts to an extension to what we saw with the <span class="math inline">\(t\)</span>-test:</p>
<ul>
<li>All flat lines with slopes of zero is equivalent to the Null hypothesis
<ul>
<li><span class="math inline">\(H_{0}\)</span> the group means are <em>all</em> equal</li>
</ul></li>
<li>At least one <span class="math inline">\(p\)</span>-value that suggests the slope is rare is equivalent to the Alternative hypothesis
<ul>
<li><span class="math inline">\(H_{1}\)</span> the group means are not <em>all</em> equal</li>
</ul></li>
</ul>
<p>In other words we can think of the ANOVA testing the idea that all the groups are the result of random sampling from all the observations, if this were true the slopes between groups would all be the same.</p>
<p>It’s by using the <em>post-hoc</em> tests like Tukey’s we get at the specific differences between groups.</p>
</div>
<div id="extra-credit-testing-specific-interactions" class="section level2">
<h2><span class="header-section-number">7.8</span> Extra Credit: Testing specific interactions</h2>
<p>The table output is a bit rich and confusing, you can get a simpler output at the expense of some more work. For the two sets of interactions we’re interested in we can look at them specifically but naming them explicitly in <code>glht</code> is trickier than we’ve done so far.</p>
<p>We have to specify a matrix of comparisons ourselves. The first step is to work out all the different interactions of the levels of the <code>food*condiment</code> interaction term. We can do that with the <code>interaction()</code> function</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="anova-and-linear-models.html#cb100-1"></a>f_c_interactions &lt;-<span class="st"> </span><span class="kw">interaction</span>(food<span class="op">$</span>Food, food<span class="op">$</span>Condiment, <span class="dt">sep=</span><span class="st">&quot;:&quot;</span>)</span>
<span id="cb100-2"><a href="anova-and-linear-models.html#cb100-2"></a><span class="kw">head</span>(f_c_interactions)</span></code></pre></div>
<pre><code>## [1] Tortilla Chips:Hummous Tortilla Chips:Hummous Tortilla Chips:Hummous
## [4] Tortilla Chips:Hummous Tortilla Chips:Hummous Tortilla Chips:Hummous
## 4 Levels: Porridge:Hummous Tortilla Chips:Hummous ... Tortilla Chips:Jam</code></pre>
<p>We can see that this is just a factor object with all the combinations of <code>Food</code> and <code>Condiment</code>. Using the <code>levels()</code> function gives us all the unique values in the order that R will use them.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="anova-and-linear-models.html#cb102-1"></a><span class="kw">levels</span>(f_c_interactions)</span></code></pre></div>
<pre><code>## [1] &quot;Porridge:Hummous&quot;       &quot;Tortilla Chips:Hummous&quot; &quot;Porridge:Jam&quot;          
## [4] &quot;Tortilla Chips:Jam&quot;</code></pre>
<p>Now we can make the matrix, our eventual matrix will look like this</p>
<pre><code>##                                           Porridge:Hummous
## Porridge:Jam - Tortilla Chips:Jam                        0
## Porridge:Hummous - Tortilla Chips:Hummous                1
##                                           Tortilla Chips:Hummous Porridge:Jam
## Porridge:Jam - Tortilla Chips:Jam                              0            1
## Porridge:Hummous - Tortilla Chips:Hummous                     -1            0
##                                           Tortilla Chips:Jam
## Porridge:Jam - Tortilla Chips:Jam                         -1
## Porridge:Hummous - Tortilla Chips:Hummous                  0</code></pre>
<p>We can see that there is a row per comparison and a column per possible interaction. At the intersection we write a zero if we don’t want to include that possible interaction in the contrast, a 1 if we want it to be the first part and a -1 if we want it to be the second part (IE, the part after the minus sign).</p>
<p>As the <code>levels()</code> function gives us the order, we set up the rows one by one and join them together.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="anova-and-linear-models.html#cb105-1"></a>P.J_TC.J &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb105-2"><a href="anova-and-linear-models.html#cb105-2"></a>P.H_TC.H &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span></code></pre></div>
<p>Now we can stick them together, use the <code>levels()</code> function as the column names and add row names. Note you can call the rows what you like, so you dont have to use the long names, but the columns <em>must</em> be named and ordered according to the <code>levels()</code> function</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="anova-and-linear-models.html#cb106-1"></a>contr_of_interest &lt;-<span class="st"> </span><span class="kw">rbind</span>(P.J_TC.J, P.H_TC.H)</span>
<span id="cb106-2"><a href="anova-and-linear-models.html#cb106-2"></a><span class="kw">colnames</span>(contr_of_interest) &lt;-<span class="st"> </span><span class="kw">levels</span>(f_c_interactions)</span>
<span id="cb106-3"><a href="anova-and-linear-models.html#cb106-3"></a><span class="kw">rownames</span>(contr_of_interest) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;P:J - TC:J&quot;</span>,</span>
<span id="cb106-4"><a href="anova-and-linear-models.html#cb106-4"></a>          <span class="st">&quot;P:H - TC:H&quot;</span>)</span>
<span id="cb106-5"><a href="anova-and-linear-models.html#cb106-5"></a></span>
<span id="cb106-6"><a href="anova-and-linear-models.html#cb106-6"></a>contr_of_interest</span></code></pre></div>
<pre><code>##            Porridge:Hummous Tortilla Chips:Hummous Porridge:Jam
## P:J - TC:J                0                      0            1
## P:H - TC:H                1                     -1            0
##            Tortilla Chips:Jam
## P:J - TC:J                 -1
## P:H - TC:H                  0</code></pre>
<p>Now we can do the test using the custom matrix.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="anova-and-linear-models.html#cb108-1"></a><span class="kw">summary</span>(<span class="kw">glht</span>( interaction_model, <span class="dt">linfct =</span> contr_of_interest))</span></code></pre></div>
<pre><code>## 
## 	 Simultaneous Tests for General Linear Hypotheses
## 
## Fit: lm(formula = Enjoyment ~ Food + Condiment + Food:Condiment, data = food)
## 
## Linear Hypotheses:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## P:J - TC:J == 0   88.862      3.021   29.41   &lt;1e-10 ***
## P:H - TC:H == 0   30.144      2.136   14.11   &lt;1e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>And there we have the specific interaction contrasts. Note how in doing this we don’t generate any warnings even though we used the model with the explicit interaction term, this is because when we generate our own contrast matrix like this we get an appropriate orthogonality for the test.</p>

<div class="roundup">
<ul>
<li>Working with multiple variables goes the same as working with just one</li>
<li>ANOVA is a flexible tool for specifying comparisons between variables in linear models</li>
</ul>
</div>


<div class="task">

</div>


</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="t-tests-and-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="non-parametric-tests-and-linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["intro_to_stats.pdf", "intro_to_stats.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
