<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 9 \(\chi ^2\) tests and linear models | Understanding Statistical Thinking With Linear Models</title>
  <meta name="description" content="Topic 9 \(\chi ^2\) tests and linear models | Understanding Statistical Thinking With Linear Models" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 9 \(\chi ^2\) tests and linear models | Understanding Statistical Thinking With Linear Models" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 9 \(\chi ^2\) tests and linear models | Understanding Statistical Thinking With Linear Models" />
  
  
  

<meta name="author" content="Dan MacLean" />


<meta name="date" content="2020-11-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="non-parametric-tests-and-linear-models.html"/>
<link rel="next" href="more-fun-with-linear-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Statistics Primer</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to statistics</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-r"><i class="fa fa-check"></i><b>1.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installing-rstudio"><i class="fa fa-check"></i><b>1.3</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#installing-r-packages-in-rstudio."><i class="fa fa-check"></i><b>1.4</b> Installing R packages in RStudio.</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#standard-packages---devtools"><i class="fa fa-check"></i><b>1.4.1</b> Standard packages - <code>devtools</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#development-packages---gradethis-and-itssl"><i class="fa fa-check"></i><b>1.4.2</b> Development packages - <code>gradethis</code> and <code>itssl</code></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#using-the-itssl-package"><i class="fa fa-check"></i><b>1.5</b> Using the <code>itssl</code> package</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Motivation</a></li>
<li class="chapter" data-level="3" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>3</b> Background</a><ul>
<li class="chapter" data-level="3.1" data-path="background.html"><a href="background.html#null-models"><i class="fa fa-check"></i><b>3.1</b> Null Models</a></li>
<li class="chapter" data-level="3.2" data-path="background.html"><a href="background.html#p-values"><i class="fa fa-check"></i><b>3.2</b> <span class="math inline">\(p\)</span>-values</a></li>
<li class="chapter" data-level="3.3" data-path="background.html"><a href="background.html#slopes-of-straight-lines-can-help-us-think-about-differences-between-things"><i class="fa fa-check"></i><b>3.3</b> Slopes of straight lines can help us think about differences between things</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>4</b> The Linear Model</a><ul>
<li class="chapter" data-level="4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#from-straight-lines-to-data"><i class="fa fa-check"></i><b>4.1</b> From straight lines to data</a></li>
<li class="chapter" data-level="4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#straight-line-relationships-are-described-using-two-parameters"><i class="fa fa-check"></i><b>4.2</b> Straight line relationships are described using two parameters</a></li>
<li class="chapter" data-level="4.3" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-try-to-create-a-linear-equation-from-data"><i class="fa fa-check"></i><b>4.3</b> Linear models try to create a linear equation from data</a></li>
<li class="chapter" data-level="4.4" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-describe-relationships-between-variables"><i class="fa fa-check"></i><b>4.4</b> Linear models describe relationships between variables</a></li>
<li class="chapter" data-level="4.5" data-path="the-linear-model.html"><a href="the-linear-model.html#not-all-lines-of-best-fit-are-equally-good"><i class="fa fa-check"></i><b>4.5</b> Not all lines of best fit are equally good</a></li>
<li class="chapter" data-level="4.6" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-contain-statistics-describing-the-goodness-of-the-model"><i class="fa fa-check"></i><b>4.6</b> Linear models contain statistics describing the goodness of the model</a><ul>
<li class="chapter" data-level="4.6.1" data-path="the-linear-model.html"><a href="the-linear-model.html#residual-standard-error"><i class="fa fa-check"></i><b>4.6.1</b> Residual Standard Error</a></li>
<li class="chapter" data-level="4.6.2" data-path="the-linear-model.html"><a href="the-linear-model.html#r2"><i class="fa fa-check"></i><b>4.6.2</b> <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="4.6.3" data-path="the-linear-model.html"><a href="the-linear-model.html#f-statistic"><i class="fa fa-check"></i><b>4.6.3</b> <span class="math inline">\(F\)</span>-Statistic</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="the-linear-model.html"><a href="the-linear-model.html#coefficients-have-statistics"><i class="fa fa-check"></i><b>4.7</b> Coefficients have statistics</a><ul>
<li class="chapter" data-level="4.7.1" data-path="the-linear-model.html"><a href="the-linear-model.html#estimate"><i class="fa fa-check"></i><b>4.7.1</b> Estimate</a></li>
<li class="chapter" data-level="4.7.2" data-path="the-linear-model.html"><a href="the-linear-model.html#std.-error"><i class="fa fa-check"></i><b>4.7.2</b> Std. Error</a></li>
<li class="chapter" data-level="4.7.3" data-path="the-linear-model.html"><a href="the-linear-model.html#t-value"><i class="fa fa-check"></i><b>4.7.3</b> <span class="math inline">\(t\)</span>-value</a></li>
<li class="chapter" data-level="4.7.4" data-path="the-linear-model.html"><a href="the-linear-model.html#prt"><i class="fa fa-check"></i><b>4.7.4</b> <span class="math inline">\(Pr(&gt;|t|)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="the-linear-model.html"><a href="the-linear-model.html#a-non-zero-slope-is-what-matters"><i class="fa fa-check"></i><b>4.8</b> A non-zero slope is what matters</a></li>
<li class="chapter" data-level="4.9" data-path="the-linear-model.html"><a href="the-linear-model.html#major-points"><i class="fa fa-check"></i><b>4.9</b> Major points</a></li>
<li class="chapter" data-level="4.10" data-path="the-linear-model.html"><a href="the-linear-model.html#extra-credit-understanding-linear-models-through-the-notation"><i class="fa fa-check"></i><b>4.10</b> Extra credit: Understanding linear models through the notation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>5</b> R Fundamentals</a><ul>
<li class="chapter" data-level="5.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#about-this-chapter"><i class="fa fa-check"></i><b>5.1</b> About this chapter</a></li>
<li class="chapter" data-level="5.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#working-with-r"><i class="fa fa-check"></i><b>5.2</b> Working with R</a></li>
<li class="chapter" data-level="5.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#variables"><i class="fa fa-check"></i><b>5.3</b> Variables</a><ul>
<li class="chapter" data-level="5.3.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#using-objects-and-functions"><i class="fa fa-check"></i><b>5.3.1</b> Using objects and functions</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#dataframes"><i class="fa fa-check"></i><b>5.4</b> Dataframes</a></li>
<li class="chapter" data-level="5.5" data-path="r-fundamentals.html"><a href="r-fundamentals.html#packages"><i class="fa fa-check"></i><b>5.5</b> Packages</a></li>
<li class="chapter" data-level="5.6" data-path="r-fundamentals.html"><a href="r-fundamentals.html#using-r-help"><i class="fa fa-check"></i><b>5.6</b> Using R Help</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html"><i class="fa fa-check"></i><b>6</b> <span class="math inline">\(t\)</span>-tests and linear models</a><ul>
<li class="chapter" data-level="6.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#recap"><i class="fa fa-check"></i><b>6.1</b> Recap</a><ul>
<li class="chapter" data-level="6.1.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-slope-of-the-model-again"><i class="fa fa-check"></i><b>6.1.1</b> The slope of the model again</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#using-two-different-samples-instead-of-a-continuous-x-variable"><i class="fa fa-check"></i><b>6.2</b> Using two different samples instead of a continuous <span class="math inline">\(x\)</span> variable</a></li>
<li class="chapter" data-level="6.3" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-plantgrowth-data"><i class="fa fa-check"></i><b>6.3</b> The PlantGrowth data</a></li>
<li class="chapter" data-level="6.4" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#a-linear-model-with-a-categoric-x-axis"><i class="fa fa-check"></i><b>6.4</b> A linear model with a categoric <span class="math inline">\(x\)</span>-axis</a></li>
<li class="chapter" data-level="6.5" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#using-the-statistics-of-the-linear-model-to-test-for-differences"><i class="fa fa-check"></i><b>6.5</b> Using the statistics of the linear model to test for differences</a><ul>
<li class="chapter" data-level="6.5.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-coefficient-and-the-mean-difference-between-groups-are-equivalent"><i class="fa fa-check"></i><b>6.5.1</b> The coefficient and the mean difference between groups are equivalent</a></li>
<li class="chapter" data-level="6.5.2" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-p-value-of-the-co-efficient-tests-the-same-thing-as-a-t-test"><i class="fa fa-check"></i><b>6.5.2</b> The <span class="math inline">\(p\)</span>-value of the co-efficient tests the same thing as a <span class="math inline">\(t\)</span>-test</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#summary"><i class="fa fa-check"></i><b>6.6</b> Summary</a></li>
<li class="chapter" data-level="6.7" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#but-wasnt-the-t-test-just-easier"><i class="fa fa-check"></i><b>6.7</b> But wasn’t the <span class="math inline">\(t\)</span>-test just easier?</a></li>
<li class="chapter" data-level="6.8" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#task"><i class="fa fa-check"></i><b>6.8</b> Task</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html"><i class="fa fa-check"></i><b>7</b> ANOVA and linear models</a><ul>
<li class="chapter" data-level="7.1" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#comparing-groups-in-a-single-variable"><i class="fa fa-check"></i><b>7.1</b> Comparing groups in a single variable</a></li>
<li class="chapter" data-level="7.2" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#one-way-comparisons---groups-in-a-single-variable"><i class="fa fa-check"></i><b>7.2</b> One-Way comparisons - groups in a single variable</a></li>
<li class="chapter" data-level="7.3" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#two-way-comparisons---groups-in-multiple-variables"><i class="fa fa-check"></i><b>7.3</b> Two-Way comparisons - groups in multiple variables</a></li>
<li class="chapter" data-level="7.4" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#interactions-between-variables"><i class="fa fa-check"></i><b>7.4</b> Interactions between variables</a><ul>
<li class="chapter" data-level="7.4.1" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#analysing-and-modelling-an-interaction-effect"><i class="fa fa-check"></i><b>7.4.1</b> Analysing and modelling an interaction effect</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#doing-all-pairwise-interactions"><i class="fa fa-check"></i><b>7.5</b> Doing all pairwise interactions</a></li>
<li class="chapter" data-level="7.6" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#summary"><i class="fa fa-check"></i><b>7.6</b> Summary</a></li>
<li class="chapter" data-level="7.7" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#extra-credit-anova-model-level-p-and-as-a-hypothesis-test"><i class="fa fa-check"></i><b>7.7</b> Extra Credit: ANOVA model-level <span class="math inline">\(p\)</span> and as a hypothesis test</a></li>
<li class="chapter" data-level="7.8" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#extra-credit-testing-specific-interactions"><i class="fa fa-check"></i><b>7.8</b> Extra Credit: Testing specific interactions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html"><i class="fa fa-check"></i><b>8</b> Non-parametric tests and linear models</a><ul>
<li class="chapter" data-level="8.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#common-misrepresentations-of-discrete-data"><i class="fa fa-check"></i><b>8.1</b> Common misrepresentations of discrete data</a><ul>
<li class="chapter" data-level="8.1.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#twisting-names-into-numbers-confuses-the-mind"><i class="fa fa-check"></i><b>8.1.1</b> Twisting names into numbers confuses the mind</a></li>
<li class="chapter" data-level="8.1.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#this-does-not-mean-what-i-think-you-think-it-means"><i class="fa fa-check"></i><b>8.1.2</b> This does not mean what I think you think it means</a></li>
<li class="chapter" data-level="8.1.3" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#build-a-strong-foundation"><i class="fa fa-check"></i><b>8.1.3</b> Build a strong foundation</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#setting-type-properly"><i class="fa fa-check"></i><b>8.2</b> Setting type properly</a><ul>
<li class="chapter" data-level="8.2.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#setting-type-with-read_csv"><i class="fa fa-check"></i><b>8.2.1</b> Setting type with <code>read_csv()</code></a></li>
<li class="chapter" data-level="8.2.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#setting-type-post-hoc-with-transmute"><i class="fa fa-check"></i><b>8.2.2</b> Setting type <em>post hoc</em> with <code>transmute()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#plots-with-categoric-x-and-y-axis"><i class="fa fa-check"></i><b>8.3</b> Plots with categoric <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axis</a></li>
<li class="chapter" data-level="8.4" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#linear-models-and-a-categoric-y-variable"><i class="fa fa-check"></i><b>8.4</b> Linear models and a categoric <span class="math inline">\(y\)</span> variable</a><ul>
<li class="chapter" data-level="8.4.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#ordered-categoric-response-variables"><i class="fa fa-check"></i><b>8.4.1</b> Ordered categoric response variables</a></li>
<li class="chapter" data-level="8.4.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#making-linear-models-with-ranked-data"><i class="fa fa-check"></i><b>8.4.2</b> Making linear models with ranked data</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#hypothesis-tests"><i class="fa fa-check"></i><b>8.5</b> Hypothesis Tests</a><ul>
<li class="chapter" data-level="8.5.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#but-arent-the-tests-just-easier"><i class="fa fa-check"></i><b>8.5.1</b> But aren’t the tests just easier?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html"><i class="fa fa-check"></i><b>9</b> <span class="math inline">\(\chi ^2\)</span> tests and linear models</a><ul>
<li class="chapter" data-level="9.1" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#the-problem-with-unordered-response-data"><i class="fa fa-check"></i><b>9.1</b> The problem with unordered response data</a></li>
<li class="chapter" data-level="9.2" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#we-have-to-compare-models-not-groups."><i class="fa fa-check"></i><b>9.2</b> We have to compare models, not groups.</a></li>
<li class="chapter" data-level="9.3" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#the-chi2-test"><i class="fa fa-check"></i><b>9.3</b> The <span class="math inline">\(\chi^2\)</span> test</a><ul>
<li class="chapter" data-level="9.3.1" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#performing-the-test"><i class="fa fa-check"></i><b>9.3.1</b> Performing the test</a></li>
<li class="chapter" data-level="9.3.2" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#more-than-one-variable"><i class="fa fa-check"></i><b>9.3.2</b> More than one variable</a></li>
<li class="chapter" data-level="9.3.3" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#more-than-one-pairwise-comparison"><i class="fa fa-check"></i><b>9.3.3</b> More than one pairwise comparison</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#summary"><i class="fa fa-check"></i><b>9.4</b> Summary</a></li>
<li class="chapter" data-level="9.5" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#plot-ideas-for-categoric-and-count-data"><i class="fa fa-check"></i><b>9.5</b> Plot ideas for categoric and count data</a><ul>
<li class="chapter" data-level="9.5.1" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#balloon-plot"><i class="fa fa-check"></i><b>9.5.1</b> Balloon plot</a></li>
<li class="chapter" data-level="9.5.2" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#heatmap"><i class="fa fa-check"></i><b>9.5.2</b> Heatmap</a></li>
<li class="chapter" data-level="9.5.3" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#stacked-bar"><i class="fa fa-check"></i><b>9.5.3</b> Stacked bar</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html"><i class="fa fa-check"></i><b>10</b> More fun with linear models</a><ul>
<li class="chapter" data-level="10.1" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#assessing-a-linear-model"><i class="fa fa-check"></i><b>10.1</b> Assessing a linear model</a><ul>
<li class="chapter" data-level="10.1.1" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#the-terror-of-normality"><i class="fa fa-check"></i><b>10.1.1</b> The terror of normality</a></li>
<li class="chapter" data-level="10.1.2" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#checking-whether-the-mean-is-a-good-summary"><i class="fa fa-check"></i><b>10.1.2</b> Checking whether the mean is a good summary</a></li>
<li class="chapter" data-level="10.1.3" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#spotting-a-good-fit-to-the-data"><i class="fa fa-check"></i><b>10.1.3</b> Spotting a good fit to the data</a></li>
<li class="chapter" data-level="10.1.4" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#checking-qq-plots-for-a-normal-distribution"><i class="fa fa-check"></i><b>10.1.4</b> Checking qq-plots for a normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#predictions"><i class="fa fa-check"></i><b>10.2</b> Predictions</a><ul>
<li class="chapter" data-level="10.2.1" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#intuition-on-prediction-from-continuous-variables"><i class="fa fa-check"></i><b>10.2.1</b> Intuition on prediction from continuous variables</a></li>
<li class="chapter" data-level="10.2.2" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#intuition-on-prediction-with-categoric-variables"><i class="fa fa-check"></i><b>10.2.2</b> Intuition on prediction with categoric variables</a></li>
<li class="chapter" data-level="10.2.3" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#using-predictions-in-more-complicated-models"><i class="fa fa-check"></i><b>10.2.3</b> Using predictions in more complicated models</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#generalized-linear-models"><i class="fa fa-check"></i><b>10.3</b> Generalized Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Understanding Statistical Thinking With Linear Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chi-2-tests-and-linear-models" class="section level1">
<h1><span class="header-section-number">Topic 9</span> <span class="math inline">\(\chi ^2\)</span> tests and linear models</h1>
<ol style="list-style-type: decimal">
<li>Questions</li>
</ol>
<ul>
<li>How do linear models apply when both the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are not continuous?</li>
<li>How can I analyse counts of stuff?</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Objectives</li>
</ol>
<ul>
<li>Appreciate that the linear model idea does not translate intuitively to this data</li>
<li>Learn how to do a <span class="math inline">\(\chi^2\)</span> test for a given number of variables</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Keypoints</li>
</ol>
<ul>
<li>Linear models applied in the place of <span class="math inline">\(\chi^2\)</span> tests are fiddly and in practice we are better off using the hypothesis tests</li>
</ul>
<p>In the last chapter we looked at discrete data that was ordered and got around it, as hypothesis tests do, by working on ranked data with a linear model. In this section we’ll look at discrete data that isn’t ordered, or is nominal, things like <code>agree, disagree, don't know</code>, or <code>yellow, green, wrinkled, smooth</code>. We’ll also look at discrete data in the form of counts or frequencies.</p>
<div id="the-problem-with-unordered-response-data" class="section level2">
<h2><span class="header-section-number">9.1</span> The problem with unordered response data</h2>
<p>If we have unordered categoric response data (<span class="math inline">\(y\)</span>-axis) we find ourselves in a bit of a pickle if we want to use try and apply a linear model to understand relationships, because there are no numbers <em>at all</em>. In every other example we’ve looked at the <span class="math inline">\(y\)</span> response data has been numeric or at least coercible into numbers.</p>
<p>We’ll put ourselves in the shoes of Gregor Mendel and work through his monohybrid cross experiment on flower colour. Mendel’s first step would have been to work out the flower colours after a cross with different coloured true breeding parents, leaving him with a raw dataframe like this:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="chi-2-tests-and-linear-models.html#cb145-1"></a><span class="kw">library</span>(itssl)</span>
<span id="cb145-2"><a href="chi-2-tests-and-linear-models.html#cb145-2"></a><span class="kw">its_mendel_data_time</span>()</span></code></pre></div>
<pre><code>## # A tibble: 600 x 2
##    cross result
##    &lt;chr&gt; &lt;chr&gt; 
##  1 PP    P     
##  2 WP    P     
##  3 WW    W     
##  4 PW    P     
##  5 PP    P     
##  6 PP    P     
##  7 WP    P     
##  8 WP    P     
##  9 PP    P     
## 10 PP    P     
## # … with 590 more rows</code></pre>
<p>Which isn’t very helpful at this stage, how on earth do we get two columns of text into a linear model? Perservering, Mendel would’ve gone on to count the numbers of each colour.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="chi-2-tests-and-linear-models.html#cb147-1"></a><span class="kw">its_mendel_count_data_time</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   colour count
##   &lt;chr&gt;  &lt;int&gt;
## 1 P        458
## 2 W        142</code></pre>
<p>Mendel famously went on to calculate the ratios, or relative frequencies of each.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="chi-2-tests-and-linear-models.html#cb149-1"></a><span class="kw">its_mendel_frequency_time</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 x 6
##       P     W ratio_p ratio_w freq_p freq_w
##   &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1   451   149    3.03       1  0.752  0.248</code></pre>
<p>But that doesn’t get us any nearer. The problem is that we have just got count (or frequency) data and nothing else. It seems that it isn’t far from the ordered data case, we can imagine plotting the data as we did with HR score, but the response variable is colour and there’s no clear explanatory (<span class="math inline">\(x\)</span>) variable, so what would go on that axis? If we had more categories we could get something but there isn’t an order so we can’t meaningfully apply the rank to create a proxy for order. We can’t look at slopes again because there’s no sense in the order of the response variable. In short it’s a mess.</p>
</div>
<div id="we-have-to-compare-models-not-groups." class="section level2">
<h2><span class="header-section-number">9.2</span> We have to compare models, not groups.</h2>
<p>It is possible to do this sort of comparison with linear models, but it gets to be fiddly and involved because we need to apply a mathematical transformation to our counts and to work on the likelihood ratio of the response to stick to some assumptions of the modelling process.</p>
<p>Briefly we go from this linear model, with interaction terms</p>
<pre><code>y ~ a + b + c + a:b</code></pre>
<p>To two models with logs all over them, one with interaction terms, one without</p>
<pre><code>log(yi) ~ log(N) + log(ai) + log(bi) + log(ci) + log(aibi)
log(yi) ~ log(N) + log(ai) + log(bi) + log(ci)</code></pre>
<p>And then we have to compare the models to see which fit the data best.</p>
<p>Which is more complicated than we want to get into and ultimately the process is not worth it in most cases, because there are alternatives. Pragmatically, the answer is to use the <span class="math inline">\(\chi^2\)</span> and related tests in this case.</p>
<p>It is worthwhile to remember that to analyse unordered categoric response data we need to compare models, because that means assessing which model ‘fit’ the data we have best. This is a useful way to think about what the tests like the <span class="math inline">\(\chi^2\)</span> and Fisher’s Exact test are doing. They compare the observed counts - being considered one full set of data (or one model), against the expected counts from some ideal or some category split, a second model.</p>
<p>The log-linear model and the tests give closely equivalent results in most cases.</p>
</div>
<div id="the-chi2-test" class="section level2">
<h2><span class="header-section-number">9.3</span> The <span class="math inline">\(\chi^2\)</span> test</h2>
<p>In the <span class="math inline">\(\chi^2\)</span> test we ask ‘does one set of counts differ from another?’. This might be a hypothetical ‘expected’ set of counts for the response of interest compared to some standard.
For example, in genetics data we might ask whether the observed ratio of phenotypes matches an expected <code>9:3:3:1</code>. More generally, we might ask whether the counts in one subset of categories matches another, so in a survey to ask whether respondents agree that broccoli is a nice food, with response ‘agree, disagree, don’t know’, we might compare responses between adults and children.</p>
<p>The basic calculation in the <span class="math inline">\(\chi^2\)</span> test is the difference between observed and expected numbers in each category subset. In Mendel’s data this would be the difference between the observed number of “P” and “W”, from the expected number - given we did 600 plants, then for a <span class="math inline">\(3:1\)</span> we’d expect 450 “P” and 150 “W”. This difference is then compared to values of the <span class="math inline">\(\chi^2\)</span> distribution and returns a <span class="math inline">\(p\)</span>-value that represents how far away from the mean the difference is. If it is an extreme value (in the tails) the <span class="math inline">\(p\)</span>-value is lower.</p>
<p>The hypotheses are set as follows:</p>
<ul>
<li><span class="math inline">\(H_{0}\)</span> the observed counts show no evidence that they are different from the expected counts</li>
<li><span class="math inline">\(H_{1}\)</span> the observed counts would not occur often by chance</li>
</ul>
<div id="performing-the-test" class="section level3">
<h3><span class="header-section-number">9.3.1</span> Performing the test</h3>
<p>To do the test for the simplest case - Mendel’s flower data, we need to get a dataframe with the observed counts on one row and the expected counts on another.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="chi-2-tests-and-linear-models.html#cb153-1"></a>observed_counts &lt;-<span class="st"> </span><span class="kw">its_mendel_count_data_time</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb153-2"><a href="chi-2-tests-and-linear-models.html#cb153-2"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> <span class="kw">c</span>(<span class="st">&quot;colour&quot;</span>), <span class="dt">values_from =</span> <span class="kw">c</span>(<span class="st">&quot;count&quot;</span>) )</span>
<span id="cb153-3"><a href="chi-2-tests-and-linear-models.html#cb153-3"></a>observed_counts</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##       P     W
##   &lt;int&gt; &lt;int&gt;
## 1   452   148</code></pre>
<p>We then need to make the equivalent row for the expected counts - recall we had 600 plants, so calculate the expected number of “P” and “W”</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="chi-2-tests-and-linear-models.html#cb155-1"></a>expected_counts &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb155-2"><a href="chi-2-tests-and-linear-models.html#cb155-2"></a>   <span class="dt">P =</span> <span class="dv">600</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span>,</span>
<span id="cb155-3"><a href="chi-2-tests-and-linear-models.html#cb155-3"></a>   <span class="dt">W =</span>  <span class="dv">600</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">4</span></span>
<span id="cb155-4"><a href="chi-2-tests-and-linear-models.html#cb155-4"></a>)</span>
<span id="cb155-5"><a href="chi-2-tests-and-linear-models.html#cb155-5"></a>expected_counts</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##       P     W
##   &lt;dbl&gt; &lt;dbl&gt;
## 1   450   150</code></pre>
<p>We then need to stick those rows together</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="chi-2-tests-and-linear-models.html#cb157-1"></a>chi_sq_input &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(observed_counts, expected_counts)</span>
<span id="cb157-2"><a href="chi-2-tests-and-linear-models.html#cb157-2"></a><span class="kw">rownames</span>(chi_sq_input) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;observed&quot;</span>, <span class="st">&quot;expected&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Setting row names on a tibble is deprecated.</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="chi-2-tests-and-linear-models.html#cb159-1"></a>chi_sq_input</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##       P     W
## * &lt;dbl&gt; &lt;dbl&gt;
## 1   452   148
## 2   450   150</code></pre>
<p>Finally we can do the test with the function <code>chisq.test()</code></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="chi-2-tests-and-linear-models.html#cb161-1"></a><span class="kw">chisq.test</span>(chi_sq_input)</span></code></pre></div>
<pre><code>## 
## 	Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  chi_sq_input
## X-squared = 0.0044644, df = 1, p-value = 0.9467</code></pre>
<p>The test shows us that the <span class="math inline">\(p\)</span>-value of the <span class="math inline">\(\chi^2\)</span> test is greater than 0.05 so we conclude that there is no evidence that the observed number of each flower colour differs from the expected and that we do indeed have a <span class="math inline">\(3:1\)</span> ratio. Note that the test automatically does the necessary correction for small sample sizes if the data need it.</p>
</div>
<div id="more-than-one-variable" class="section level3">
<h3><span class="header-section-number">9.3.2</span> More than one variable</h3>
<p>The data we had above only had one variable, flower colour. What if we have multiple categoric variables to compare? Largely, the process is the same but making the table is more difficult.</p>
<p>Consider this data frame of voting intentions between generations</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="chi-2-tests-and-linear-models.html#cb163-1"></a><span class="co">##Turn into function in the package</span></span>
<span id="cb163-2"><a href="chi-2-tests-and-linear-models.html#cb163-2"></a>voting_data &lt;-<span class="st"> </span><span class="kw">its_voting_data_time</span>()</span>
<span id="cb163-3"><a href="chi-2-tests-and-linear-models.html#cb163-3"></a>voting_data</span></code></pre></div>
<pre><code>##   generation alignment count
## 1     boomer   fascist   279
## 2  millenial   fascist   165
## 3     boomer instagram    74
## 4  millenial instagram    47
## 5     boomer   marxist   225
## 6  millenial   marxist   191</code></pre>
<p>This time we have two variables, with two or three levels of each. To make the contingency table for <code>chisq.test()</code> we can use <code>xtabs()</code> which takes an R formula as a description of how to make the table. Luckily, these are exactly the same formula we used to make linear models.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="chi-2-tests-and-linear-models.html#cb165-1"></a>tabulated &lt;-<span class="st"> </span><span class="kw">xtabs</span>(count <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> voting_data)</span>
<span id="cb165-2"><a href="chi-2-tests-and-linear-models.html#cb165-2"></a>tabulated</span></code></pre></div>
<pre><code>##            alignment
## generation  fascist instagram marxist
##   boomer        279        74     225
##   millenial     165        47     191</code></pre>
<p>Here we make a formula that says <code>count</code> is the output variable, and <code>.</code> are the independent or row and column variables (<code>.</code> in formula like this just means everything else). The table comes out as we expect and we can go on to do the <code>chisq.test()</code> as before on the new table.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="chi-2-tests-and-linear-models.html#cb167-1"></a><span class="kw">chisq.test</span>(tabulated)</span></code></pre></div>
<pre><code>## 
## 	Pearson&#39;s Chi-squared test
## 
## data:  tabulated
## X-squared = 7.0811, df = 2, p-value = 0.029</code></pre>
<p>Here the <span class="math inline">\(p\)</span> value tells us that the pattern of voting intention is significant, but the numbers are hard to interpret … do <code>millenial</code>s vote less for <code>instagram</code> than <code>boomer</code>s? We can make things easier to interpret if we have a proportion table. The function <code>prop.table()</code> can make one of those.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="chi-2-tests-and-linear-models.html#cb169-1"></a><span class="kw">prop.table</span>(tabulated, <span class="dt">margin =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##            alignment
## generation    fascist instagram   marxist
##   boomer    0.4826990 0.1280277 0.3892734
##   millenial 0.4094293 0.1166253 0.4739454</code></pre>
<p>The <code>margin</code> option takes a <code>1</code> if we want proportions across the rows, <code>2</code> if we want proportions down the columns. We can see that the difference between the two generations comes largely from a swing from <code>fascist</code> to <code>marxist</code>.</p>
</div>
<div id="more-than-one-pairwise-comparison" class="section level3">
<h3><span class="header-section-number">9.3.3</span> More than one pairwise comparison</h3>
<p>If we have more than two levels in our comparison category (that is, a larger contingency table than 2 x 2), we run into a problem. Look at these data</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="chi-2-tests-and-linear-models.html#cb171-1"></a>job_mood &lt;-<span class="st"> </span><span class="kw">its_job_mood_time</span>()</span></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="chi-2-tests-and-linear-models.html#cb172-1"></a>tab &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Freq <span class="op">~</span>., <span class="dt">data =</span> job_mood)</span>
<span id="cb172-2"><a href="chi-2-tests-and-linear-models.html#cb172-2"></a>tab</span></code></pre></div>
<pre><code>##            role
## mood        carpenter cooper milliner
##   curious          70      0      100
##   tense            32     30       30
##   whimsical       120    142      110</code></pre>
<p>we have data on the reported mood of people in different jobs. Note that there are three levels of each of the categoric variables. We can make the table and can go straight to the <span class="math inline">\(\chi^2\)</span> test.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="chi-2-tests-and-linear-models.html#cb174-1"></a>tab &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Freq <span class="op">~</span>., <span class="dt">data =</span> job_mood)</span>
<span id="cb174-2"><a href="chi-2-tests-and-linear-models.html#cb174-2"></a>tab</span></code></pre></div>
<pre><code>##            role
## mood        carpenter cooper milliner
##   curious          70      0      100
##   tense            32     30       30
##   whimsical       120    142      110</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="chi-2-tests-and-linear-models.html#cb176-1"></a><span class="kw">chisq.test</span>(tab)</span></code></pre></div>
<pre><code>## 
## 	Pearson&#39;s Chi-squared test
## 
## data:  tab
## X-squared = 93.67, df = 4, p-value &lt; 2.2e-16</code></pre>
<p>Umm, it’s significant. But weren’t we expecting to see significances between groups? As with the ANOVA it’s done the overall result. We need to do a <em>post-hoc</em> operation to do the full set of pairwise comparisons. The package <code>rcompanion</code> has a nice function for this, <code>pairwiseNominalIndependence()</code>, we set the option <code>method</code> to decide which correction for multiple comparisons to do, <code>fdr</code> is a good choice.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="chi-2-tests-and-linear-models.html#cb178-1"></a><span class="kw">library</span>(rcompanion)</span>
<span id="cb178-2"><a href="chi-2-tests-and-linear-models.html#cb178-2"></a><span class="kw">pairwiseNominalIndependence</span>(tab, <span class="dt">method =</span> <span class="st">&quot;fdr&quot;</span>)</span></code></pre></div>
<pre><code>##            Comparison p.Fisher p.adj.Fisher  p.Gtest p.adj.Gtest  p.Chisq
## 1     curious : tense 8.97e-16     1.35e-15 2.22e-16    3.33e-16 1.07e-14
## 2 curious : whimsical 8.98e-29     2.69e-28 0.00e+00    0.00e+00 5.47e-21
## 3   tense : whimsical 5.98e-01     5.98e-01 6.07e-01    6.07e-01 6.11e-01
##   p.adj.Chisq
## 1    1.60e-14
## 2    1.64e-20
## 3    6.11e-01</code></pre>
<p>Better. But not quite! The groups compared are the different <code>moods</code>, presumably we wanted to look at the differences between the different <code>roles</code>. The table is in the wrong orientation in that case.</p>
<p>We can explicitly state the orientation of the table by manipulating the formula in <code>xtabs()</code>. Compare the results of these two calls</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="chi-2-tests-and-linear-models.html#cb180-1"></a><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>role <span class="op">+</span><span class="st"> </span>mood, <span class="dt">data =</span> job_mood)</span></code></pre></div>
<pre><code>##            mood
## role        curious tense whimsical
##   carpenter      70    32       120
##   cooper          0    30       142
##   milliner      100    30       110</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="chi-2-tests-and-linear-models.html#cb182-1"></a><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>mood <span class="op">+</span><span class="st"> </span>role, <span class="dt">data =</span> job_mood)</span></code></pre></div>
<pre><code>##            role
## mood        carpenter cooper milliner
##   curious          70      0      100
##   tense            32     30       30
##   whimsical       120    142      110</code></pre>
<p>We usually want the form with the variable we’re comparing in the rows, that’s the <code>Freq ~ role + mood</code>. We can then do the pairwise <span class="math inline">\(\chi^2\)</span>.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="chi-2-tests-and-linear-models.html#cb184-1"></a>tab &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>role <span class="op">+</span><span class="st"> </span>mood, <span class="dt">data =</span> job_mood)</span>
<span id="cb184-2"><a href="chi-2-tests-and-linear-models.html#cb184-2"></a><span class="kw">pairwiseNominalIndependence</span>(tab, <span class="dt">method =</span> <span class="st">&quot;fdr&quot;</span>)</span></code></pre></div>
<pre><code>##             Comparison p.Fisher p.adj.Fisher p.Gtest p.adj.Gtest  p.Chisq
## 1   carpenter : cooper 5.26e-20     7.89e-20  0.0000      0.0000 3.38e-15
## 2 carpenter : milliner 7.81e-02     7.81e-02  0.0773      0.0773 7.81e-02
## 3    cooper : milliner 1.66e-28     4.98e-28  0.0000      0.0000 1.89e-21
##   p.adj.Chisq
## 1    5.07e-15
## 2    7.81e-02
## 3    5.67e-21</code></pre>
<p>And we can now clearly see the <span class="math inline">\(p\)</span>-values across all the group comparisons. The default output is actually from a range of <span class="math inline">\(\chi^2\)</span> related tests. In this case always take the <code>p.adj</code> value as the final <span class="math inline">\(p\)</span>-value.</p>
</div>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">9.4</span> Summary</h2>
<p>We’ve finally seen a situation where the linear model paradigm for thinking about statistical tests and hypothesis let’s us down, the categorical <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axis gets just a bit <em>too</em> complicated for the lines idea to remain intuitive, so here we must abandon it. But the alternative hypothesis tests in the <span class="math inline">\(\chi^2\)</span> family are still available and we’ve learned some useful and general ways to apply those.</p>
</div>
<div id="plot-ideas-for-categoric-and-count-data" class="section level2">
<h2><span class="header-section-number">9.5</span> Plot ideas for categoric and count data</h2>
<p>In previous chapters we’ve seen how to plot the data we’ve been working on and usually the sort of plot we want has been quite obvious. With the unordered categoric only data we have here, it isn’t so obvious. Often just the table will do! But if you would like some plots here are some rough examples to build from.</p>
<div id="balloon-plot" class="section level3">
<h3><span class="header-section-number">9.5.1</span> Balloon plot</h3>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="chi-2-tests-and-linear-models.html#cb186-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb186-2"><a href="chi-2-tests-and-linear-models.html#cb186-2"></a><span class="kw">ggplot</span>(job_mood) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(mood, role) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size =</span> Freq))</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
<p>This plot shows circles whose size is proportional to the count at each combination.</p>
</div>
<div id="heatmap" class="section level3">
<h3><span class="header-section-number">9.5.2</span> Heatmap</h3>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="chi-2-tests-and-linear-models.html#cb187-1"></a><span class="kw">ggplot</span>(job_mood) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(mood, role) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>Freq))</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
<p>This plot shows tiles whose filled colour represents the count at each combination</p>
</div>
<div id="stacked-bar" class="section level3">
<h3><span class="header-section-number">9.5.3</span> Stacked bar</h3>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="chi-2-tests-and-linear-models.html#cb188-1"></a><span class="kw">ggplot</span>(job_mood) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(role, Freq) <span class="op">+</span><span class="st"> </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> mood))</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>

<ol style="list-style-type: decimal">
<li>Questions</li>
</ol>
<ul>
<li>How do I know whether my model is any good?</li>
<li>How can I use the model to make predictions?</li>
<li>What can I use when linear models don’t work well?</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Objectives</li>
</ol>
<ul>
<li>Learn how to tell whether the data you have are suitable for linear models</li>
<li>Learn how to make predictions from a model</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Keypoints</li>
</ol>
<ul>
<li>Data should be normally distributed, but linear models are quite robust to deviation from this</li>
<li>Models can be used to make new hypotheses</li>
<li>Linear models are one member of a larger family of models for many types of data</li>
</ul>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="non-parametric-tests-and-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="more-fun-with-linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["intro_to_stats.pdf", "intro_to_stats.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
