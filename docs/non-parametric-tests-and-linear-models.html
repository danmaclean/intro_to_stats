<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 8 Non-parametric tests and linear models | Understanding Statistical Thinking With Linear Models</title>
  <meta name="description" content="Topic 8 Non-parametric tests and linear models | Understanding Statistical Thinking With Linear Models" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 8 Non-parametric tests and linear models | Understanding Statistical Thinking With Linear Models" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 8 Non-parametric tests and linear models | Understanding Statistical Thinking With Linear Models" />
  
  
  

<meta name="author" content="Dan MacLean" />


<meta name="date" content="2021-08-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="anova-and-linear-models.html"/>
<link rel="next" href="chi-2-tests-and-linear-models.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Statistics Primer</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Setting up</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#knowledge-prerequisites"><i class="fa fa-check"></i><b>1.1.1</b> Knowledge prerequisites</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#software-prerequisites"><i class="fa fa-check"></i><b>1.1.2</b> Software prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-r"><i class="fa fa-check"></i><b>1.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installing-rstudio"><i class="fa fa-check"></i><b>1.3</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#installing-r-packages-in-rstudio."><i class="fa fa-check"></i><b>1.4</b> Installing R packages in RStudio.</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#standard-packages---devtools"><i class="fa fa-check"></i><b>1.4.1</b> Standard packages - <code>devtools</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#development-packages---itssl"><i class="fa fa-check"></i><b>1.4.2</b> Development packages - itssl</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#using-the-itssl-package"><i class="fa fa-check"></i><b>1.5</b> Using the <code>itssl</code> package</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Motivation</a></li>
<li class="chapter" data-level="3" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>3</b> Background</a>
<ul>
<li class="chapter" data-level="3.1" data-path="background.html"><a href="background.html#null-models"><i class="fa fa-check"></i><b>3.1</b> Null Models</a></li>
<li class="chapter" data-level="3.2" data-path="background.html"><a href="background.html#p-values"><i class="fa fa-check"></i><b>3.2</b> <span class="math inline">\(p\)</span>-values</a></li>
<li class="chapter" data-level="3.3" data-path="background.html"><a href="background.html#slopes-of-straight-lines-can-help-us-think-about-differences-between-things"><i class="fa fa-check"></i><b>3.3</b> Slopes of straight lines can help us think about differences between things</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>4</b> The Linear Model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#from-straight-lines-to-data"><i class="fa fa-check"></i><b>4.1</b> From straight lines to data</a></li>
<li class="chapter" data-level="4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#straight-line-relationships-are-described-using-two-parameters"><i class="fa fa-check"></i><b>4.2</b> Straight line relationships are described using two parameters</a></li>
<li class="chapter" data-level="4.3" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-try-to-create-a-linear-equation-from-data"><i class="fa fa-check"></i><b>4.3</b> Linear models try to create a linear equation from data</a></li>
<li class="chapter" data-level="4.4" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-describe-relationships-between-variables"><i class="fa fa-check"></i><b>4.4</b> Linear models describe relationships between variables</a></li>
<li class="chapter" data-level="4.5" data-path="the-linear-model.html"><a href="the-linear-model.html#not-all-lines-of-best-fit-are-equally-good"><i class="fa fa-check"></i><b>4.5</b> Not all lines of best fit are equally good</a></li>
<li class="chapter" data-level="4.6" data-path="the-linear-model.html"><a href="the-linear-model.html#linear-models-contain-statistics-describing-the-goodness-of-the-model"><i class="fa fa-check"></i><b>4.6</b> Linear models contain statistics describing the goodness of the model</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="the-linear-model.html"><a href="the-linear-model.html#residual-standard-error"><i class="fa fa-check"></i><b>4.6.1</b> Residual Standard Error</a></li>
<li class="chapter" data-level="4.6.2" data-path="the-linear-model.html"><a href="the-linear-model.html#r2"><i class="fa fa-check"></i><b>4.6.2</b> <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="4.6.3" data-path="the-linear-model.html"><a href="the-linear-model.html#f-statistic"><i class="fa fa-check"></i><b>4.6.3</b> <span class="math inline">\(F\)</span>-Statistic</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="the-linear-model.html"><a href="the-linear-model.html#coefficients-have-statistics"><i class="fa fa-check"></i><b>4.7</b> Coefficients have statistics</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="the-linear-model.html"><a href="the-linear-model.html#estimate"><i class="fa fa-check"></i><b>4.7.1</b> Estimate</a></li>
<li class="chapter" data-level="4.7.2" data-path="the-linear-model.html"><a href="the-linear-model.html#std.-error"><i class="fa fa-check"></i><b>4.7.2</b> Std. Error</a></li>
<li class="chapter" data-level="4.7.3" data-path="the-linear-model.html"><a href="the-linear-model.html#t-value"><i class="fa fa-check"></i><b>4.7.3</b> <span class="math inline">\(t\)</span>-value</a></li>
<li class="chapter" data-level="4.7.4" data-path="the-linear-model.html"><a href="the-linear-model.html#prt"><i class="fa fa-check"></i><b>4.7.4</b> <span class="math inline">\(Pr(&gt;|t|)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="the-linear-model.html"><a href="the-linear-model.html#a-non-zero-slope-is-what-matters"><i class="fa fa-check"></i><b>4.8</b> A non-zero slope is what matters</a></li>
<li class="chapter" data-level="4.9" data-path="the-linear-model.html"><a href="the-linear-model.html#major-points"><i class="fa fa-check"></i><b>4.9</b> Major points</a></li>
<li class="chapter" data-level="4.10" data-path="the-linear-model.html"><a href="the-linear-model.html#extra-credit-understanding-linear-models-through-the-notation"><i class="fa fa-check"></i><b>4.10</b> Extra credit: Understanding linear models through the notation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>5</b> R Fundamentals</a>
<ul>
<li class="chapter" data-level="5.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#about-this-chapter"><i class="fa fa-check"></i><b>5.1</b> About this chapter</a></li>
<li class="chapter" data-level="5.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#working-with-r"><i class="fa fa-check"></i><b>5.2</b> Working with R</a></li>
<li class="chapter" data-level="5.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#variables"><i class="fa fa-check"></i><b>5.3</b> Variables</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#using-objects-and-functions"><i class="fa fa-check"></i><b>5.3.1</b> Using objects and functions</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#dataframes"><i class="fa fa-check"></i><b>5.4</b> Dataframes</a></li>
<li class="chapter" data-level="5.5" data-path="r-fundamentals.html"><a href="r-fundamentals.html#packages"><i class="fa fa-check"></i><b>5.5</b> Packages</a></li>
<li class="chapter" data-level="5.6" data-path="r-fundamentals.html"><a href="r-fundamentals.html#using-r-help"><i class="fa fa-check"></i><b>5.6</b> Using R Help</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html"><i class="fa fa-check"></i><b>6</b> <span class="math inline">\(t\)</span>-tests and linear models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#recap"><i class="fa fa-check"></i><b>6.1</b> Recap</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-slope-of-the-model-again"><i class="fa fa-check"></i><b>6.1.1</b> The slope of the model again</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#using-two-different-samples-instead-of-a-continuous-x-variable"><i class="fa fa-check"></i><b>6.2</b> Using two different samples instead of a continuous <span class="math inline">\(x\)</span> variable</a></li>
<li class="chapter" data-level="6.3" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-plantgrowth-data"><i class="fa fa-check"></i><b>6.3</b> The PlantGrowth data</a></li>
<li class="chapter" data-level="6.4" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#a-linear-model-with-a-categoric-x-axis"><i class="fa fa-check"></i><b>6.4</b> A linear model with a categoric <span class="math inline">\(x\)</span>-axis</a></li>
<li class="chapter" data-level="6.5" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#using-the-statistics-of-the-linear-model-to-test-for-differences"><i class="fa fa-check"></i><b>6.5</b> Using the statistics of the linear model to test for differences</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-coefficient-and-the-mean-difference-between-groups-are-equivalent"><i class="fa fa-check"></i><b>6.5.1</b> The coefficient and the mean difference between groups are equivalent</a></li>
<li class="chapter" data-level="6.5.2" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#the-p-value-of-the-co-efficient-tests-the-same-thing-as-a-t-test"><i class="fa fa-check"></i><b>6.5.2</b> The <span class="math inline">\(p\)</span>-value of the co-efficient tests the same thing as a <span class="math inline">\(t\)</span>-test</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#summary"><i class="fa fa-check"></i><b>6.6</b> Summary</a></li>
<li class="chapter" data-level="6.7" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#but-wasnt-the-t-test-just-easier"><i class="fa fa-check"></i><b>6.7</b> But wasn’t the <span class="math inline">\(t\)</span>-test just easier?</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html"><i class="fa fa-check"></i><b>7</b> ANOVA and linear models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#comparing-groups-in-a-single-variable"><i class="fa fa-check"></i><b>7.1</b> Comparing groups in a single variable</a></li>
<li class="chapter" data-level="7.2" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#one-way-comparisons---groups-in-a-single-variable"><i class="fa fa-check"></i><b>7.2</b> One-Way comparisons - groups in a single variable</a></li>
<li class="chapter" data-level="7.3" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#two-way-comparisons---groups-in-multiple-variables"><i class="fa fa-check"></i><b>7.3</b> Two-Way comparisons - groups in multiple variables</a></li>
<li class="chapter" data-level="7.4" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#interactions-between-variables"><i class="fa fa-check"></i><b>7.4</b> Interactions between variables</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#analysing-and-modelling-an-interaction-effect"><i class="fa fa-check"></i><b>7.4.1</b> Analysing and modelling an interaction effect</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#doing-all-pairwise-interactions"><i class="fa fa-check"></i><b>7.5</b> Doing all pairwise interactions</a></li>
<li class="chapter" data-level="7.6" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#summary"><i class="fa fa-check"></i><b>7.6</b> Summary</a></li>
<li class="chapter" data-level="7.7" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#extra-credit-anova-model-level-p-and-as-a-hypothesis-test"><i class="fa fa-check"></i><b>7.7</b> Extra Credit: ANOVA model-level <span class="math inline">\(p\)</span> and as a hypothesis test</a></li>
<li class="chapter" data-level="7.8" data-path="anova-and-linear-models.html"><a href="anova-and-linear-models.html#extra-credit-testing-specific-interactions"><i class="fa fa-check"></i><b>7.8</b> Extra Credit: Testing specific interactions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html"><i class="fa fa-check"></i><b>8</b> Non-parametric tests and linear models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#common-misrepresentations-of-discrete-data"><i class="fa fa-check"></i><b>8.1</b> Common misrepresentations of discrete data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#twisting-names-into-numbers-confuses-the-mind"><i class="fa fa-check"></i><b>8.1.1</b> Twisting names into numbers confuses the mind</a></li>
<li class="chapter" data-level="8.1.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#this-does-not-mean-what-i-think-you-think-it-means"><i class="fa fa-check"></i><b>8.1.2</b> This does not mean what I think you think it means</a></li>
<li class="chapter" data-level="8.1.3" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#build-a-strong-foundation"><i class="fa fa-check"></i><b>8.1.3</b> Build a strong foundation</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#setting-type-properly"><i class="fa fa-check"></i><b>8.2</b> Setting type properly</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#setting-type-with-read_csv"><i class="fa fa-check"></i><b>8.2.1</b> Setting type with <code>read_csv()</code></a></li>
<li class="chapter" data-level="8.2.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#setting-type-post-hoc-with-transmute"><i class="fa fa-check"></i><b>8.2.2</b> Setting type <em>post hoc</em> with <code>transmute()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#plots-with-categoric-x-and-y-axis"><i class="fa fa-check"></i><b>8.3</b> Plots with categoric <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axis</a></li>
<li class="chapter" data-level="8.4" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#linear-models-and-a-categoric-y-variable"><i class="fa fa-check"></i><b>8.4</b> Linear models and a categoric <span class="math inline">\(y\)</span> variable</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#ordered-categoric-response-variables"><i class="fa fa-check"></i><b>8.4.1</b> Ordered categoric response variables</a></li>
<li class="chapter" data-level="8.4.2" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#making-linear-models-with-ranked-data"><i class="fa fa-check"></i><b>8.4.2</b> Making linear models with ranked data</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#hypothesis-tests"><i class="fa fa-check"></i><b>8.5</b> Hypothesis Tests</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="non-parametric-tests-and-linear-models.html"><a href="non-parametric-tests-and-linear-models.html#but-arent-the-tests-just-easier"><i class="fa fa-check"></i><b>8.5.1</b> But aren’t the tests just easier?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html"><i class="fa fa-check"></i><b>9</b> <span class="math inline">\(\chi ^2\)</span> tests and linear models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#the-problem-with-unordered-response-data"><i class="fa fa-check"></i><b>9.1</b> The problem with unordered response data</a></li>
<li class="chapter" data-level="9.2" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#we-have-to-compare-models-not-groups."><i class="fa fa-check"></i><b>9.2</b> We have to compare models, not groups.</a></li>
<li class="chapter" data-level="9.3" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#the-chi2-test"><i class="fa fa-check"></i><b>9.3</b> The <span class="math inline">\(\chi^2\)</span> test</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#performing-the-test"><i class="fa fa-check"></i><b>9.3.1</b> Performing the test</a></li>
<li class="chapter" data-level="9.3.2" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#more-than-one-variable"><i class="fa fa-check"></i><b>9.3.2</b> More than one variable</a></li>
<li class="chapter" data-level="9.3.3" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#more-than-one-pairwise-comparison"><i class="fa fa-check"></i><b>9.3.3</b> More than one pairwise comparison</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="t-tests-and-linear-models.html"><a href="t-tests-and-linear-models.html#summary"><i class="fa fa-check"></i><b>9.4</b> Summary</a></li>
<li class="chapter" data-level="9.5" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#plot-ideas-for-categoric-and-count-data"><i class="fa fa-check"></i><b>9.5</b> Plot ideas for categoric and count data</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#balloon-plot"><i class="fa fa-check"></i><b>9.5.1</b> Balloon plot</a></li>
<li class="chapter" data-level="9.5.2" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#heatmap"><i class="fa fa-check"></i><b>9.5.2</b> Heatmap</a></li>
<li class="chapter" data-level="9.5.3" data-path="chi-2-tests-and-linear-models.html"><a href="chi-2-tests-and-linear-models.html#stacked-bar"><i class="fa fa-check"></i><b>9.5.3</b> Stacked bar</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html"><i class="fa fa-check"></i><b>10</b> More fun with linear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#assessing-a-linear-model"><i class="fa fa-check"></i><b>10.1</b> Assessing a linear model</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#the-terror-of-normality"><i class="fa fa-check"></i><b>10.1.1</b> The terror of normality</a></li>
<li class="chapter" data-level="10.1.2" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#checking-whether-the-mean-is-a-good-summary"><i class="fa fa-check"></i><b>10.1.2</b> Checking whether the mean is a good summary</a></li>
<li class="chapter" data-level="10.1.3" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#spotting-a-good-fit-to-the-data"><i class="fa fa-check"></i><b>10.1.3</b> Spotting a good fit to the data</a></li>
<li class="chapter" data-level="10.1.4" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#checking-qq-plots-for-a-normal-distribution"><i class="fa fa-check"></i><b>10.1.4</b> Checking qq-plots for a normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#predictions"><i class="fa fa-check"></i><b>10.2</b> Predictions</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#intuition-on-prediction-from-continuous-variables"><i class="fa fa-check"></i><b>10.2.1</b> Intuition on prediction from continuous variables</a></li>
<li class="chapter" data-level="10.2.2" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#intuition-on-prediction-with-categoric-variables"><i class="fa fa-check"></i><b>10.2.2</b> Intuition on prediction with categoric variables</a></li>
<li class="chapter" data-level="10.2.3" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#using-predictions-in-more-complicated-models"><i class="fa fa-check"></i><b>10.2.3</b> Using predictions in more complicated models</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="more-fun-with-linear-models.html"><a href="more-fun-with-linear-models.html#generalized-linear-models"><i class="fa fa-check"></i><b>10.3</b> Generalized Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Understanding Statistical Thinking With Linear Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="non-parametric-tests-and-linear-models" class="section level1" number="8">
<h1><span class="header-section-number">Topic 8</span> Non-parametric tests and linear models</h1>
<ol style="list-style-type: decimal">
<li>Questions</li>
</ol>
<ul>
<li>How do I can I analyse data in non-numeric scales?</li>
<li>What are the common mistakes when analysing non-numeric data?</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Objectives</li>
</ol>
<ul>
<li>Learn how to spot the places we mix up categoric and non-categoric data</li>
<li>Understand how to use ranked data in a linear model</li>
<li>Understand ordered and unordered factors</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Keypoints</li>
</ol>
<ul>
<li>Using numbers as names does not make data quantitative</li>
<li>Ranking data makes it possible to analyse ordered categoric data in a linear model</li>
</ul>
<p>So far we’ve looked at tests where the dependent or response measurement has been continuous, that is a measurable number on a continuous scale, like mass or fluorescence. In this section we’ll look at how straight lines can be used to understand differences when we have a discrete or categorical response output. A discrete response variable is one where we have certain categories of result, ‘tall’ or ‘short,’ ‘dead’ or ‘alive’ or ‘infected’ or ‘not.’ You’ll likely be familiar with these approaches from such things as the chi-squared (<span class="math inline">\(\chi^2\)</span>) test or other so-called ‘non-parametric’ test like the Mann-Whitney.</p>
<p>We’ll start by looking at how these data really are different from the data we’ve used already, common mistakes are always enlightening.</p>
<div id="common-misrepresentations-of-discrete-data" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Common misrepresentations of discrete data</h2>
<p>A common place where analysing discrete data goes wrong is when the analyst confuses the categoric with the continuous, this is often caused by a bad naming scheme as much as a lack of appreciation of the real nature of the data. Often, using numbers as the names for categories can lead the unaware analyst to make a critical mistake. Let’s consider a plant infection assay (sometimes called an HR assay). Here a large-ish leaf of a plant is infected at points on its surface with either different strains or varieties of some pathogen and controls. After a period of incubation the severity of disease at each patch is assessed by eye and a score of disease applied. Sometimes that score will be a numeric one that may be like this example from Supplemental Figure 1 A in a 2020 PNAS paper by Gao et al. <span class="citation"><a href="references.html#ref-Gao9613" role="doc-biblioref">Gao et al.</a> (<a href="references.html#ref-Gao9613" role="doc-biblioref">2020</a>)</span></p>
<p><img src="fig/dong_figs1A.png" alt="An HR index picture" />
In the figure we can see that a number has been attached to a category, roughly an amount of disease. The numbers increase as disease does but it is a very rough and therefore discontinuous fit. The change in size in numbers don’t relate to each other in the same way that the changes in disease do. The unit difference from 0 to 1 doesn’t seem to be copied in any of the other units and 5 doesnt have just 5 times more apparent disease than 1. The scale has numbers in it, but it isn’t continuous.</p>
<p>We can see what the scale represents if we try and use words to express the categories.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="non-parametric-tests-and-linear-models.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(itssl)</span>
<span id="cb110-2"><a href="non-parametric-tests-and-linear-models.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">its_hr_score_scheme_time</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">severity</th>
<th align="center">score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Dead</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">Very Ill</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">Ill</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">No Effect</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>Which looks fine at first glance, but again isn’t continuous.</p>
<p>Typically this will be used in a replicated infection experiment and give data that look like this when collected, which is where the problem arises.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="non-parametric-tests-and-linear-models.html#cb111-1" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">its_hr_scores_time</span>()</span>
<span id="cb111-2"><a href="non-parametric-tests-and-linear-models.html#cb111-2" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span> <span class="fu">its_table_time</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">strain</th>
<th align="center">replicate</th>
<th align="center">score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">control</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">mild</td>
<td align="center">1</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">deadly</td>
<td align="center">1</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">control</td>
<td align="center">2</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">mild</td>
<td align="center">2</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">deadly</td>
<td align="center">2</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">control</td>
<td align="center">3</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">mild</td>
<td align="center">3</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">deadly</td>
<td align="center">3</td>
<td align="center">3</td>
</tr>
</tbody>
</table>
<p>We now have a table that looks to computers and humans alike as if it is full of numbers, which it isn’t, its full of numbers in the place of words. A simple mental test is to try and use the categories as numbers and see if they behave. For example, is a score of ‘2’ twice that of ‘1,’ in this case, is ‘Ill’ twice the effect of ‘No Effect?’ Clearly it isn’t, confirming that these numbers aren’t continuous numbers at all, merely place holders for some other conception of the severity of the disease.</p>
<p>The problem is exacerbated by not paying attention to this and jumping straight to a plot. Consider this:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="non-parametric-tests-and-linear-models.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb112-2"><a href="non-parametric-tests-and-linear-models.html#cb112-2" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb112-3"><a href="non-parametric-tests-and-linear-models.html#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(strain, score) <span class="sc">+</span> </span>
<span id="cb112-4"><a href="non-parametric-tests-and-linear-models.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> replicate))</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<p>Looks good?</p>
<p>No. By the sweet warmth of the first suns of spring, no.</p>
<p>These data are misrepresented by this plot. There are some alarm bells that should ring when we look at this. The first is that scale for replicate. The scale shows replicate values like 1.5 and 2.5 - we didn’t do a replicate 1.5 (not least because it doesn’t make sense to do a replicate .5). So why has <code>ggplot</code> drawn that scale - because it saw numbers and assumed the data in this column are continuous and not discrete. This needs fixing, the replicate is a category, really, not a number. We wouldn’t lose any meaning if we used <code>A,B,C</code> or <code>one,two,three</code> and while the computer is good at recognising text as categories, it just thinks the numbers are real numbers. So we’ll need to avoid doing this, or be prepared to correct it.</p>

<div class="sidenote">
By using numbers for our score, then we have been able to use ‘geom_jitter()’ as a representation and it has generated additions to the scores that leave it with decimal points and that isn’t correct either. It seems defensible on the grounds that if we didn’t use geom_jitter() all the points would be in one place but to avoid the problem we should be doing something very different in the first place.
</div>
<div id="twisting-names-into-numbers-confuses-the-mind" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Twisting names into numbers confuses the mind</h3>
<p>The next level of mistake that follows from believing that the scores are numbers is treating them like numbers. We often see the plot evolve in this manner</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="non-parametric-tests-and-linear-models.html#cb113-1" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb113-2"><a href="non-parametric-tests-and-linear-models.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(strain, score) <span class="sc">+</span> </span>
<span id="cb113-3"><a href="non-parametric-tests-and-linear-models.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb113-4"><a href="non-parametric-tests-and-linear-models.html#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> replicate))</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-101-1.png" width="672" /></p>
<p>What the cuss? This is a dreadful misrepresentation of the data!</p>
<p>This plot makes us see things that aren’t really there - particularly statistics like means and ranges, and relative magnitude differences between categories.</p>
</div>
<div id="this-does-not-mean-what-i-think-you-think-it-means" class="section level3" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> This does not mean what I think you think it means</h3>
<p>Well, not you specifically, but someone. Someone definitely thinks what I think they think it means because this mistake keeps coming up.<br />
We think we can see these statistics because the boxplot shows them. But the boxplot is a dreamlike fabrication. The things it purports to show like the mean of the data, its interquartile range etc are each a numeric feature calculated using formulae based on numbers. But these data are not numbers - they are category names that happen to have digits to represent them. We’ve squeezed numbers in where no numbers should be and invented statistical lies.</p>
<p>The use of numbers as names for the categories created a problem of mental overloading - simultaneaously knowing that the data are categorical and treating them as continuous. Believing that because we’ve used numbers for categories we can treat them as numbers. On top of this the presentation tricks our mind into considering the results as if these statistics were real.</p>
<p>If we use the actual category names we see how ridiculous the boxplot is - consider <code>mean(Ill, No Effect, Ill) = 0.66</code>, it doesn’t make any sense. By using numbers as proxies for our categories, we’ve confused the issue and the knock-on effect is that we start to read (conciously or unconciously) things we shouldn’t from the plot. One unavoidable impression from the plot is that ‘mild’ strain is somehow about 3/4 of the badness of the ‘deadly’ strain. Does that mean the plants were three-quarters dead? Of course not. The misrepresentation in these plots leaves with bad intuition about the relationships in our data.</p>
<p>The use of boxplots to show categories is seductive, it gives an impression of transparency and apparent differences when we use numbers, this is a case where the road to hell is paved with good intentions.</p>
<p>With these plots as a base the analysts next move is to run statistical analysis in the way we have learned and, sadly, generate results that are worse than meaningless.</p>
<p>And indeed this does happen in published results, see this figure from the same Gao et al <span class="citation"><a href="references.html#ref-Gao9613" role="doc-biblioref">Gao et al.</a> (<a href="references.html#ref-Gao9613" role="doc-biblioref">2020</a>)</span> paper .</p>
<p><img src="fig/dong_fig1A.png" alt="An HR Barchart using categoric data" />
A barchart with all the errors we mentioned, the bars represent means, the error bars represent standard errors and the legend reports an ANOVA done on these data that concludes a significant reduction in the one low sample.</p>
</div>
<div id="build-a-strong-foundation" class="section level3" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Build a strong foundation</h3>
<p>We must avoid these category confusions. There are some key places we can do this in our analysis workflow</p>
<ul>
<li>Know and declare the proper data type to R</li>
<li>Use a statistical test/model type appropriate to the datatype</li>
</ul>
<p>When we load our data into R, we’ll need to make sure that we use the right data types. As a result of this we’ll find that the plots we try to make will come out more appropriately - R will adapt to the data as far as it can. Second, when it comes to doing hypothesis tests we will have to use the proper test for the data type. As we are using the linear model as the basis for our interpretations we’ll need to learn the adaptations to that.</p>
<p>In the rest of this chapter we’ll look at correctly describing data to R, creating an appropriate plot for some data and then back to our main thread - using the linear model as a basis for our understanding of statistical tests - this time with categorical response variable.</p>
</div>
</div>
<div id="setting-type-properly" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Setting type properly</h2>
<p>At the start of an analysis, when we’re loading data into R is our best opportunity to correct datatype, before we’ve done any work on it and before it starts to get in the way. In a lot of everyday cases we’ll be loading text in from an Excel file or something similar like a <code>.csv</code> or <code>.txt</code> file, so that will be our example case.</p>

<div class="sidenote">
Base R provides the ‘read.csv()’ (<em>read dot csv</em>) function for us to load ‘.csv’ files and no option for loading Excel files. The tidyverse packages readr and readxl provide the read_csv() and read_excel() (<em>read underscore csv</em>) options respectively. You’ll see read.csv() a lot in older code and quick tutorials, but it is a bit clunky. Some of read.csv()’s default behaviours can be a bit unpredictable and we have to undo some of its work sometimes. So we’ll look at the more consistent tidyverse offerings.
</div>
<div id="setting-type-with-read_csv" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Setting type with <code>read_csv()</code></h3>
<p>On loading data with <code>read_csv()</code>, we get a column specification - this tells us what R thinks each column contained, we must check it carefully to make sure R understands the data as you do. Here we’ll load in the mock HR data we used above.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="non-parametric-tests-and-linear-models.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb114-2"><a href="non-parametric-tests-and-linear-models.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">&quot;data/sample.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   strain = col_character(),
##   replicate = col_double(),
##   score = col_double()
## )</code></pre>
<pre><code>## # A tibble: 9 x 3
##   strain  replicate score
##   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
## 1 control         1     1
## 2 mild            1     3
## 3 deadly          1     4
## 4 control         2     2
## 5 mild            2     3
## 6 deadly          2     4
## 7 control         3     1
## 8 mild            3     3
## 9 deadly          3     3</code></pre>
<p>So we can see that R thinks the column <code>strain</code> contains <code>character</code> data (text), and the <code>replicate</code> and <code>strain</code> column data are <code>double</code> (numeric type) data. Well, almost one out of three is pretty bad. Although we (foolishly) coded the categoric <code>replicate</code> and <code>strain</code> as numbers, they aren’t, they’re categories (or factors, in statistic parlance). We can use a column specification in the <code>read_csv()</code> function to force these to be factors.</p>

<div class="sidenote">
Factors are a statistical name for a categorical variable. Each factor is made up of one or more ‘levels’ the different values that factor can take. In our HR score data, the factor would be ‘score’ and it’s levels would be ‘3,’‘1,’‘2’ and ‘4.’ There are lots of tools that work with factors in R, they are a common object.
</div>
<p>The <code>col_factor()</code> function tells R that these columns should be a factor when loading.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="non-parametric-tests-and-linear-models.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(</span>
<span id="cb117-2"><a href="non-parametric-tests-and-linear-models.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;data/sample.csv&quot;</span>,</span>
<span id="cb117-3"><a href="non-parametric-tests-and-linear-models.html#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb117-4"><a href="non-parametric-tests-and-linear-models.html#cb117-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">strain =</span> <span class="fu">col_factor</span>(<span class="cn">NULL</span>),</span>
<span id="cb117-5"><a href="non-parametric-tests-and-linear-models.html#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">replicate =</span> <span class="fu">col_factor</span>(<span class="cn">NULL</span>),</span>
<span id="cb117-6"><a href="non-parametric-tests-and-linear-models.html#cb117-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">score =</span> <span class="fu">col_factor</span>(<span class="cn">NULL</span>)</span>
<span id="cb117-7"><a href="non-parametric-tests-and-linear-models.html#cb117-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb117-8"><a href="non-parametric-tests-and-linear-models.html#cb117-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##   strain  replicate score
##   &lt;fct&gt;   &lt;fct&gt;     &lt;fct&gt;
## 1 control 1         1    
## 2 mild    1         3    
## 3 deadly  1         4    
## 4 control 2         2    
## 5 mild    2         3    
## 6 deadly  2         4    
## 7 control 3         1    
## 8 mild    3         3    
## 9 deadly  3         3</code></pre>
<p>This is much better, R now knows not to treat any of those columns as numbers, so the mistakes we’re trying to avoid are much less likely to happen.</p>
<p>We can go one step further and explicitly state the allowed values in a factor. When we do this we get to pick the order that R will deal with them in (and this is important in our data because control &lt; mild &lt; deadly in some sense) and it will spot when we try to load in a factor level that we haven’t declared, which can save us headaches down the road.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="non-parametric-tests-and-linear-models.html#cb119-1" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb119-2"><a href="non-parametric-tests-and-linear-models.html#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;data/sample.csv&quot;</span>,</span>
<span id="cb119-3"><a href="non-parametric-tests-and-linear-models.html#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb119-4"><a href="non-parametric-tests-and-linear-models.html#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">strain =</span> <span class="fu">col_factor</span>( <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;mild&quot;</span>, <span class="st">&quot;deadly&quot;</span>)),</span>
<span id="cb119-5"><a href="non-parametric-tests-and-linear-models.html#cb119-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">replicate =</span> <span class="fu">col_factor</span>( <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>)),</span>
<span id="cb119-6"><a href="non-parametric-tests-and-linear-models.html#cb119-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">score =</span> <span class="fu">col_factor</span>( <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>))</span>
<span id="cb119-7"><a href="non-parametric-tests-and-linear-models.html#cb119-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb119-8"><a href="non-parametric-tests-and-linear-models.html#cb119-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb119-9"><a href="non-parametric-tests-and-linear-models.html#cb119-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-10"><a href="non-parametric-tests-and-linear-models.html#cb119-10" aria-hidden="true" tabindex="-1"></a>scores</span></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##   strain  replicate score
##   &lt;fct&gt;   &lt;fct&gt;     &lt;fct&gt;
## 1 control 1         1    
## 2 mild    1         3    
## 3 deadly  1         4    
## 4 control 2         2    
## 5 mild    2         3    
## 6 deadly  2         4    
## 7 control 3         1    
## 8 mild    3         3    
## 9 deadly  3         3</code></pre>
<p>If you inspect this output and the one previous we can see that we have an order that respects what we told R the data should look like. This is more obvious when we plot as the axes etc will automatically come out in that order.</p>
</div>
<div id="setting-type-post-hoc-with-transmute" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Setting type <em>post hoc</em> with <code>transmute()</code></h3>
<p>Often our data won’t come straight from a file, it’ll come from some other function that had its own view on the types. To set types with any old dataframe, use <code>transmute()</code> from <code>dplyr()</code></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="non-parametric-tests-and-linear-models.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb121-2"><a href="non-parametric-tests-and-linear-models.html#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="non-parametric-tests-and-linear-models.html#cb121-3" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(</span>
<span id="cb121-4"><a href="non-parametric-tests-and-linear-models.html#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">strain =</span> <span class="fu">as.factor</span>(strain),</span>
<span id="cb121-5"><a href="non-parametric-tests-and-linear-models.html#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">replicate =</span> <span class="fu">as.factor</span>(replicate),</span>
<span id="cb121-6"><a href="non-parametric-tests-and-linear-models.html#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">as.factor</span>(score)</span>
<span id="cb121-7"><a href="non-parametric-tests-and-linear-models.html#cb121-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##   strain  replicate score
##   &lt;fct&gt;   &lt;fct&gt;     &lt;fct&gt;
## 1 control 1         1    
## 2 mild    1         3    
## 3 deadly  1         4    
## 4 control 2         2    
## 5 mild    2         3    
## 6 deadly  2         4    
## 7 control 3         1    
## 8 mild    3         3    
## 9 deadly  3         3</code></pre>
<p>Note that <code>transmute()</code> will drop any columns you don’t explicitly mention, so any unconverted columns like genuine continuous data should be included in the argument.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="non-parametric-tests-and-linear-models.html#cb123-1" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(</span>
<span id="cb123-2"><a href="non-parametric-tests-and-linear-models.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">strain =</span> <span class="fu">as.factor</span>(strain),</span>
<span id="cb123-3"><a href="non-parametric-tests-and-linear-models.html#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">replicate =</span> <span class="fu">as.factor</span>(replicate),</span>
<span id="cb123-4"><a href="non-parametric-tests-and-linear-models.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">as.factor</span>(score),</span>
<span id="cb123-5"><a href="non-parametric-tests-and-linear-models.html#cb123-5" aria-hidden="true" tabindex="-1"></a>  some_numeric_col, other_numeric_col</span>
<span id="cb123-6"><a href="non-parametric-tests-and-linear-models.html#cb123-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="plots-with-categoric-x-and-y-axis" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Plots with categoric <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axis</h2>
<p>Now we have our data in the right format we can get to plotting, let’s try and repeat the plot we went for when we first looked at these data.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="non-parametric-tests-and-linear-models.html#cb124-1" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb124-2"><a href="non-parametric-tests-and-linear-models.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(strain, score) <span class="sc">+</span></span>
<span id="cb124-3"><a href="non-parametric-tests-and-linear-models.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> replicate ))</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
<p>Better but not perfect. We get the replicate labelled properly - as discrete categories rather than a continuous scale, and the strain is in a sensible order. But the jitter still leaves us with the impression that we have numeric data. We can fix this but first let’s jump to repeating our earlier mistake with boxplots</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="non-parametric-tests-and-linear-models.html#cb125-1" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb125-2"><a href="non-parametric-tests-and-linear-models.html#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(strain, score) <span class="sc">+</span></span>
<span id="cb125-3"><a href="non-parametric-tests-and-linear-models.html#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb125-4"><a href="non-parametric-tests-and-linear-models.html#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> replicate))</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<p>OK, weird. The boxplot clearly fails, there isn’t the proper data to draw a boxplot, coding our data as factors has saved us this error too. Though not explictly! At least it sends some sort of signal that something isn’t right with our plot.</p>
<p>Moving on to evolve our plot, lets remove the jitter and go to a <code>geom_point()</code> which puts our points in the exact place, without jitter.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="non-parametric-tests-and-linear-models.html#cb126-1" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb126-2"><a href="non-parametric-tests-and-linear-models.html#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(strain, score) <span class="sc">+</span> </span>
<span id="cb126-3"><a href="non-parametric-tests-and-linear-models.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>replicate))</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
<p>this leaves us with the problem that some of our points are overlapped by others. We need a way to show them without moving them off the spot. We can do that by changing the spot size according to the number of points making it up, <code>geom_count()</code> does that for us.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="non-parametric-tests-and-linear-models.html#cb127-1" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb127-2"><a href="non-parametric-tests-and-linear-models.html#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(strain, score) <span class="sc">+</span> </span>
<span id="cb127-3"><a href="non-parametric-tests-and-linear-models.html#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>()</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<p>And with that we can see the number of datum that make up each point. This is a clearer representation of the categoric data than the early attempts and doesn’t lead us to the same poor mental models.</p>
<p>It is possible to get a prettier and more descriptive plot with the different replicates side by side and coloured, but it takes a different set of geoms and a slightly involved approach which has more to do with using <code>dplyr</code> and <code>ggplot</code> so we can leave that as an exercise for another time. The point here is that an appropriate plot for categoric data will save us from a poor understanding of the relationships in the data.</p>
</div>
<div id="linear-models-and-a-categoric-y-variable" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Linear models and a categoric <span class="math inline">\(y\)</span> variable</h2>
<p>After all that exposition about the difference of categories and plotting them properly, how can we apply our knowledge of linear models to find differences between <span class="math inline">\(x\)</span> categories now that our <span class="math inline">\(y\)</span> is also categoric and not continuous?</p>
<p>One thing we haven’t considered up to now with our categories is that, although categories don’t behave like numbers, they can behave like a queue. They often do have an intrinsic and meaningful order. A category like our HR score definitely has an order: <span class="math inline">\(score\ 1 &lt; score\ 2 &lt; score\ 3 &lt; score\ 4\)</span> even if the intervals are not smooth or equal or defined in any other way. Conversely, some categories don’t have an order, e.g species 1 and species 2 aren’t greater or lesser than each other. We need to treat ordered and unordered categories differently.</p>
<div id="ordered-categoric-response-variables" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Ordered categoric response variables</h3>
<p>The steps for working with an ordered categoric response variable are as follows</p>
<ol style="list-style-type: decimal">
<li>Convert the values observed in the ordered categoric response variable to a rank</li>
<li>Proceed as before</li>
</ol>
<p>It’s that easy! Ranks are continuous and work as if they were a continuous scale, so we can use them as we did before. Let’s look at how to rank an ordered categoric variable</p>
<p>The first step is to tell R that the factor is in fact an ordered one, and what that order is</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="non-parametric-tests-and-linear-models.html#cb128-1" aria-hidden="true" tabindex="-1"></a>observations <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;some&quot;</span>, <span class="st">&quot;some&quot;</span>, <span class="st">&quot;none&quot;</span>, <span class="st">&quot;lots&quot;</span>, <span class="st">&quot;many&quot;</span>)</span>
<span id="cb128-2"><a href="non-parametric-tests-and-linear-models.html#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="non-parametric-tests-and-linear-models.html#cb128-3" aria-hidden="true" tabindex="-1"></a>ordfac_observations <span class="ot">&lt;-</span> <span class="fu">factor</span>(observations, </span>
<span id="cb128-4"><a href="non-parametric-tests-and-linear-models.html#cb128-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;some&quot;</span>, <span class="st">&quot;many&quot;</span>, <span class="st">&quot;lots&quot;</span>, <span class="st">&quot;all&quot;</span>),</span>
<span id="cb128-5"><a href="non-parametric-tests-and-linear-models.html#cb128-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb128-6"><a href="non-parametric-tests-and-linear-models.html#cb128-6" aria-hidden="true" tabindex="-1"></a>                          )</span></code></pre></div>
<p>All we’ve done here is create some data in <code>observations</code> then turn it into a factor, the <code>levels</code> option sets the allowed levels and the <code>ordered</code> option tells R to take the given order. Let’s inspect the factor object by printing</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="non-parametric-tests-and-linear-models.html#cb129-1" aria-hidden="true" tabindex="-1"></a>ordfac_observations</span></code></pre></div>
<pre><code>## [1] none some some none lots many
## Levels: none &lt; some &lt; many &lt; lots &lt; all</code></pre>
<p>We see that R knows the data and the order of the levels. Note that even if a level doesn’t appear in the data, as long as it is declared in <code>levels</code> R still knows about it and it’s place, should it come across it.</p>
<p>We can convert to a rank quite easily with the <code>rank()</code> function.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="non-parametric-tests-and-linear-models.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rank</span>(ordfac_observations)</span></code></pre></div>
<pre><code>## [1] 1.5 3.5 3.5 1.5 6.0 5.0</code></pre>
<p>And R converts our category to a rank based on the order we provided. Note that ties are broken, so the two <code>nones</code> get equal but split rank, as do the two <code>somes</code>. This operation gives us a numeric scale we can use as if the data were continuous.</p>
</div>
<div id="making-linear-models-with-ranked-data" class="section level3" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Making linear models with ranked data</h3>
<p>Let’s calculate the rank score and add it to the score data frame with <code>transmute()</code>, then plot the rank data.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="non-parametric-tests-and-linear-models.html#cb133-1" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> scores <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(</span>
<span id="cb133-2"><a href="non-parametric-tests-and-linear-models.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">factor</span>(score, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>), <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb133-3"><a href="non-parametric-tests-and-linear-models.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank_score =</span> <span class="fu">rank</span>(score),</span>
<span id="cb133-4"><a href="non-parametric-tests-and-linear-models.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  strain,replicate</span>
<span id="cb133-5"><a href="non-parametric-tests-and-linear-models.html#cb133-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb133-6"><a href="non-parametric-tests-and-linear-models.html#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="non-parametric-tests-and-linear-models.html#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scores) <span class="sc">+</span> <span class="fu">aes</span>(strain, rank_score) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> replicate))</span></code></pre></div>
<p><img src="intro_to_stats_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
<p>We can see the ranks and replicates in the scatter plot that we are used to, we have a similar view as to that we saw with the categoric scatter plot.</p>
<p>Now we can move on to the modelling and the ANOVA</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="non-parametric-tests-and-linear-models.html#cb134-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(rank_score <span class="sc">~</span> strain, <span class="at">data =</span> scores)</span>
<span id="cb134-2"><a href="non-parametric-tests-and-linear-models.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = rank_score ~ strain, data = scores)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##   -2.0   -0.5    0.0    1.0    1.0 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    2.0000     0.6455   3.098 0.021160 *  
## strainmild     3.5000     0.9129   3.834 0.008618 ** 
## straindeadly   5.5000     0.9129   6.025 0.000944 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.118 on 6 degrees of freedom
## Multiple R-squared:  0.8611,	Adjusted R-squared:  0.8148 
## F-statistic:  18.6 on 2 and 6 DF,  p-value: 0.002679</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="non-parametric-tests-and-linear-models.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb136-2"><a href="non-parametric-tests-and-linear-models.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(</span>
<span id="cb136-3"><a href="non-parametric-tests-and-linear-models.html#cb136-3" aria-hidden="true" tabindex="-1"></a>  model, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">strain =</span> <span class="st">&quot;Tukey&quot;</span>)</span>
<span id="cb136-4"><a href="non-parametric-tests-and-linear-models.html#cb136-4" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## 
## 	 Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = rank_score ~ strain, data = scores)
## 
## Linear Hypotheses:
##                       Estimate Std. Error t value Pr(&gt;|t|)   
## mild - control == 0     3.5000     0.9129   3.834   0.0200 * 
## deadly - control == 0   5.5000     0.9129   6.025   0.0022 **
## deadly - mild == 0      2.0000     0.9129   2.191   0.1516   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>Great, some clear answers. The strains are likely not the same as the control, but there is no evidence for difference between the strains.</p>
</div>
</div>
<div id="hypothesis-tests" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Hypothesis Tests</h2>
<p>As we mentioned at the start of the chapter there are hypothesis tests that we can use instead of the linear model approach for the ordered categoric response variable case. These are the Mann-Whitney U test (also called the Wilcoxon Signed Rank test) which is for a two group situation (like a <span class="math inline">\(t\)</span>-test) and the Kruskal-Wallis test, which is for a multi-group situation (like the ANOVA).</p>
<p>However, we run into some problems when doing these tests, especially for multiple categories. The Mann-Whitney U only works on two groups, which is a limitation. It is used as below, though first we’ll need to extract the two groups we want. We will do this by filtering but then we’ll need to extract any unused levels in the filtered factor <code>strain</code> with <code>droplevels()</code></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="non-parametric-tests-and-linear-models.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb138-2"><a href="non-parametric-tests-and-linear-models.html#cb138-2" aria-hidden="true" tabindex="-1"></a>two_groups <span class="ot">&lt;-</span> <span class="fu">filter</span>(scores, strain <span class="sc">!=</span> <span class="st">&quot;deadly&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb138-3"><a href="non-parametric-tests-and-linear-models.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb138-4"><a href="non-parametric-tests-and-linear-models.html#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">score =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(score)),</span>
<span id="cb138-5"><a href="non-parametric-tests-and-linear-models.html#cb138-5" aria-hidden="true" tabindex="-1"></a>            strain, replicate</span>
<span id="cb138-6"><a href="non-parametric-tests-and-linear-models.html#cb138-6" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb138-7"><a href="non-parametric-tests-and-linear-models.html#cb138-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-8"><a href="non-parametric-tests-and-linear-models.html#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(two_groups)</span></code></pre></div>
<pre><code>## tibble [6 × 3] (S3: tbl_df/tbl/data.frame)
##  $ score    : num [1:6] 1 3 2 3 1 3
##  $ strain   : Factor w/ 2 levels &quot;control&quot;,&quot;mild&quot;: 1 2 1 2 1 2
##  $ replicate: Factor w/ 3 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;: 1 1 2 2 3 3</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="non-parametric-tests-and-linear-models.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(score <span class="sc">~</span> strain, <span class="at">data =</span> two_groups)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(x = c(1, 2, 1), y = c(3, 3, 3)): cannot compute
## exact p-value with ties</code></pre>
<pre><code>## 
## 	Wilcoxon rank sum test with continuity correction
## 
## data:  score by strain
## W = 0, p-value = 0.05935
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>So the Mann-Whitney U (Wilcoxon) test tells us that the difference between the scores between the two strains is not likely to be 0. Scaling this up to more than two groups takes a Kruskal-Wallis test</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="non-parametric-tests-and-linear-models.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(rank_score <span class="sc">~</span> strain, <span class="at">data =</span> scores)</span></code></pre></div>
<pre><code>## 
## 	Kruskal-Wallis rank sum test
## 
## data:  rank_score by strain
## Kruskal-Wallis chi-squared = 6.8889, df = 2, p-value = 0.03192</code></pre>
<p>Now this is disappointing, as the Kruskal-Wallis test tells us that at least one of the groups is different from the others, but crucially it doesn’t tell us which ones! So we end up doing a multiple <code>wilcox.test()</code> and applying a correction to the <span class="math inline">\(p\)</span>-value. The linear model and ANOVA approach, proves to be a little more straightforward now that we have the knack.</p>
<div id="but-arent-the-tests-just-easier" class="section level3" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> But aren’t the tests just easier?</h3>
<p>As with the <span class="math inline">\(t\)</span>-test, then in practice, sometimes, yes, these tests are easier. But the same reason for using the linear model applies as with the <span class="math inline">\(t\)</span>-test - it gives us a general framework in which to work and develop a good intuition about the data we are studying and a good conceptual tool with which to think about it. As ever the individual hypothesis tests are just easier. But as we’ve seen they run into limitations of their own.</p>

<div class="roundup">
<ul>
<li>It is easy to mistake categories for continuous data when numbers are use as names.</li>
<li>Using numbers as names does not make data quantitative</li>
<li>Ranking data makes it possible to analyse ordered categoric data in a linear model</li>
</ul>
</div>

<div class="task">

</div>

<div class="task">
<p>Complete the interactive tutorial online <a href="http://v1068.nbi.ac.uk/datasci/type/">http://v1068.nbi.ac.uk/datasci/type/</a></p>
This will only work on the NBI site.
</div>
<p>```</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="anova-and-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chi-2-tests-and-linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["intro_to_stats.pdf", "intro_to_stats.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
